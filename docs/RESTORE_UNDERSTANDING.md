# レストア 業務理解ドキュメント

## ドキュメント情報

- **作成日**: 2025-01-XX
- **バージョン**: 0.1
- **対象**: レストアの業務理解
- **ステータス**: 確認待ち

---

## 1. 業務の特徴

### 1-1. レストアとは

**レストア（Restore）**: 古い車両を修復・復元する作業

**特徴**:
- 古い車両を元の状態に戻す、またはより良い状態に修復する
- 長期プロジェクトになる可能性が高い
- 部品の取り寄せが必要な場合が多い
- 段階的な作業になる可能性がある
- Before/After写真が重要

### 1-2. 業務フローの想定

```
1. 予約・受付: レストア希望の車両の受付
2. 診断: 現状確認、修復箇所の確認、修復内容の決定
3. 見積作成: 修復内容、部品、作業内容に基づいて見積もりを作成
4. 顧客承認: 見積内容を確認して承認
5. 作業実施: 修復作業を実施（長期にわたる可能性がある）
6. 引渡: 修復完了後、顧客に引渡
```

---

## 2. 確認が必要な事項

### 2-1. 業務フローパターン

**質問**: 業務フローパターンはどのようになりますか？

**想定パターン**:
- **パターンA（入庫→診断→見積→承認→作業）**: 入庫してから診断を実施し、見積を作成して承認を得てから作業を実施
- **パターンB（事前見積→承認→入庫→作業）**: 事前に見積を作成して承認を得てから入庫

**確認事項**:
- どちらのパターンになりますか？
- レストアは長期プロジェクトになることが多いですか？

### 2-2. 診断内容

**質問**: 診断時に確認する内容について

**想定**:
- 現状確認（車体、エンジン、内装、電装系など）
- 修復箇所の確認
- 修復内容の決定
- Before写真の撮影（必須）

**確認事項**:
- 診断時に確認する項目は何ですか？
- 修復箇所の記録方法は？（部位、程度、写真）
- 見積もりに必要な情報は何ですか？

### 2-3. 見積もり

**質問**: 見積もりの作成方法について

**想定**:
- 修復内容、部品、作業内容に基づいて見積もりを作成
- 部品の取り寄せが必要な場合がある
- 長期プロジェクトの場合は、段階的な見積もりが必要な場合がある

**確認事項**:
- 見積もりの項目は何ですか？（修復費用、部品費用、作業費用など）
- 部品の取り寄せが必要な場合、どのように管理しますか？
- 長期プロジェクトの場合は、段階的な見積もりが必要ですか？

### 2-4. 作業実施

**質問**: 作業実施の流れについて

**想定**:
- 修復作業を実施
- 部品の取り寄せが必要な場合がある
- 長期プロジェクトの場合は、段階的な作業になる可能性がある
- 作業進捗を管理

**確認事項**:
- 作業実施の流れはどうなりますか？
- 部品の取り寄せが必要な場合、どのように管理しますか？
- 長期プロジェクトの場合は、段階的な作業管理が必要ですか？

### 2-5. 写真撮影

**質問**: 写真撮影について

**想定**:
- Before写真（現状の記録、必須）
- 作業中の写真（進捗記録）
- After写真（修復完了後の記録、必須）

**確認事項**:
- Before/After写真の撮影は必須ですか？
- 作業中の写真撮影は必要ですか？
- 撮影する箇所はどこですか？（車体全体、修復箇所など）

### 2-6. 測定値

**質問**: 測定値の入力について

**想定**:
- 修復前後の測定値（必要に応じて）
- 作業時間の記録

**確認事項**:
- 測定値の入力は必要ですか？
- どのような測定値を記録しますか？

### 2-7. PDF生成

**質問**: PDF生成について

**想定**:
- レストアではPDF生成は不要（車検・12ヶ月点検のみPDF生成）

**確認事項**:
- レストアでもPDFを生成しますか？

### 2-8. 部品の管理

**質問**: 部品の管理について

**想定**:
- レストアに必要な部品（エンジン部品、ボディ部品、内装部品、電装部品など）の管理
- 部品の取り寄せが必要な場合がある
- 部品の在庫管理が必要な場合がある

**確認事項**:
- 部品の管理は必要ですか？
- 部品の取り寄せが必要な場合、どのように管理しますか？
- 部品の在庫管理は必要ですか？

### 2-9. 作業期間

**質問**: 作業期間について

**想定**:
- レストアの作業期間は数週間から数カ月、場合によっては数年かかる場合がある
- 顧客は車を預ける必要がある

**確認事項**:
- レストアの作業期間はどの程度ですか？
- 顧客は車を預ける必要がありますか？

### 2-10. 代車の提供

**質問**: 代車の提供について

**想定**:
- 作業期間が長い場合、代車を提供する場合がある

**確認事項**:
- 代車の提供は必要ですか？
- 代車の提供はどのような場合に行いますか？

### 2-11. 長期プロジェクトの管理

**質問**: 長期プロジェクトの管理について

**回答**: ✅ **長期プロジェクトでイレギュラーが多い**

**詳細**:
- **長期プロジェクト**: レストアは長期プロジェクトになる可能性が高い
- **イレギュラーが多い**: 予定通りに進まないことが多く、追加作業や見積もりの変更が発生することが多い

**設計決定**:
- レストアは長期プロジェクトとして管理
- イレギュラー対応が必要（追加作業、見積もりの変更、部品の取り寄せ遅延など）
- 段階的な作業管理が必要
- 追加作業の管理機能が必要
- 見積もりの変更管理機能が必要
- 作業期間の延長管理が必要

---

## 3. 想定される画面設計

### 3-1. 受付画面（Phase 1）

#### 入庫処理

**設計**:
- レストア希望の車両の受付
- 走行距離を入力
- 前回レストア履歴の表示

**UI要素**:
- 走行距離入力欄
- 前回レストア履歴表示

### 3-2. 診断画面（Phase 2）

#### 現状確認と修復内容の決定

**設計**:
- 現状確認（車体、エンジン、内装、電装系など）
- 修復箇所の確認
- 修復内容の決定
- Before写真の撮影（必須）

**UI要素**:
- 現状確認チェックリスト
- 修復箇所の選択（部位、程度）
- Before写真撮影ボタン
- コメント入力欄

### 3-3. 見積作成画面（Phase 3）

#### 見積もりの作成

**設計**:
- 修復内容、部品、作業内容に基づいて見積もりを作成
- 部品の取り寄せが必要な場合の管理
- 長期プロジェクトの場合は、段階的な見積もり
- **イレギュラー対応**: 追加作業、見積もりの変更、部品の取り寄せ遅延などの管理

**UI要素**:
- 見積もり項目の入力（修復費用、部品費用、作業費用など）
- 部品リストの表示・入力
- 見積金額表示
- 作業期間の表示
- **追加作業の追加ボタン**
- **見積もりの変更履歴表示**
- **部品の取り寄せ状況表示**

### 3-4. 作業画面（Phase 5）

#### 作業記録

**設計**:
- 実施した作業の記録
- 作業中の写真撮影
- 使用した部品の記録
- 作業時間の記録
- 作業進捗の管理
- **イレギュラー対応**: 追加作業の記録、見積もりの変更、部品の取り寄せ遅延などの管理

**UI要素**:
- 作業記録入力欄
- 作業中の写真撮影ボタン
- 使用した部品入力欄
- 作業時間入力欄
- 作業メモ入力欄
- 作業進捗表示
- **追加作業の追加ボタン**
- **見積もりの変更ボタン**
- **部品の取り寄せ状況表示**

### 3-5. 引渡画面（Phase 7）

#### 顧客への引渡

**設計**:
- 修復内容を説明して引渡
- After写真の表示

**UI要素**:
- 修復内容の表示
- After写真の表示
- 引渡ボタン

---

## 4. 想定されるデータモデル

### 4-1. レストアジョブデータ

```typescript
/**
 * レストアジョブ
 */
export interface RestoreJob {
  /** Job ID */
  jobId: string;
  /** 入庫区分 */
  serviceKind: "レストア";
  
  /** 車両情報 */
  vehicle: {
    /** 車両ID */
    vehicleId: string;
    /** 走行距離 */
    mileage: number;
  };
  
  /** 診断情報 */
  diagnosis: {
    /** 現状確認結果 */
    currentCondition: ConditionCheck[];
    /** 修復箇所 */
    restoreLocations: RestoreLocation[];
    /** Before写真 */
    beforePhotos: Photo[];
    /** コメント（整備士の所見） */
    comments: string;
  };
  
  /** 見積情報 */
  estimate: {
    /** 見積もり項目 */
    items: EstimateItem[];
    /** 部品リスト */
    parts: PartItem[];
    /** 合計金額 */
    total: number;
    /** 作業期間 */
    workDuration: string;
    /** 承認日時 */
    approvedAt?: Date;
    /** 追加作業リスト（イレギュラー対応） */
    additionalWork: AdditionalWorkItem[];
    /** 見積もりの変更履歴 */
    changeHistory: EstimateChange[];
  };
  
  /** 作業情報 */
  work: {
    /** 実施した作業の記録 */
    workRecords: WorkRecord[];
    /** 作業中の写真 */
    progressPhotos: Photo[];
    /** 使用した部品 */
    usedParts: PartItem[];
    /** 作業時間 */
    workDuration: number;
    /** 作業メモ */
    notes: string;
    /** 作業進捗 */
    progress: number; // 0-100%
    /** 追加作業の記録（イレギュラー対応） */
    additionalWorkRecords: WorkRecord[];
    /** 作業期間の延長記録 */
    extensionHistory: WorkExtension[];
  };
  
  /** ステータス */
  status: "入庫待ち" | "診断中" | "見積作成待ち" | "顧客承認待ち" | "作業待ち" | "作業中" | "出庫待ち";
}

/**
 * 現状確認結果
 */
export interface ConditionCheck {
  /** 箇所 */
  location: string;
  /** 状態 */
  condition: "良好" | "軽微な劣化" | "中程度の劣化" | "深刻な劣化" | "修復必要";
  /** 写真 */
  photo?: Photo;
  /** コメント */
  comment?: string;
}

/**
 * 修復箇所
 */
export interface RestoreLocation {
  /** 部位 */
  location: string;
  /** 修復内容 */
  restoreType: "修復" | "交換" | "塗装" | "その他";
  /** 修復の程度 */
  severity: "軽微" | "中程度" | "深刻";
  /** 写真 */
  photo: Photo;
  /** コメント */
  comment?: string;
}

/**
 * 部品項目
 */
export interface PartItem {
  /** 部品名 */
  name: string;
  /** 数量 */
  quantity: number;
  /** 単価 */
  unitPrice: number;
  /** 金額 */
  amount: number;
  /** 取り寄せ状況 */
  status: "在庫あり" | "取り寄せ中" | "到着済み";
  /** 備考 */
  note?: string;
}

/**
 * 作業記録
 */
export interface WorkRecord {
  /** 作業日 */
  date: Date;
  /** 作業内容 */
  content: string;
  /** 作業時間 */
  duration: number;
  /** 写真 */
  photos?: Photo[];
  /** コメント */
  comment?: string;
}

/**
 * 追加作業項目（イレギュラー対応）
 */
export interface AdditionalWorkItem {
  /** 追加作業ID */
  id: string;
  /** 追加作業内容 */
  content: string;
  /** 追加費用 */
  additionalCost: number;
  /** 追加作業の承認日時 */
  approvedAt?: Date;
  /** 追加作業の実施日時 */
  completedAt?: Date;
  /** 備考 */
  note?: string;
}

/**
 * 見積もりの変更履歴
 */
export interface EstimateChange {
  /** 変更日時 */
  changedAt: Date;
  /** 変更内容 */
  changeContent: string;
  /** 変更前の金額 */
  previousTotal: number;
  /** 変更後の金額 */
  newTotal: number;
  /** 変更理由 */
  reason: string;
}

/**
 * 作業期間の延長記録
 */
export interface WorkExtension {
  /** 延長日時 */
  extendedAt: Date;
  /** 延長前の期間 */
  previousDuration: string;
  /** 延長後の期間 */
  newDuration: string;
  /** 延長理由 */
  reason: string;
}
```

---

## 5. 次のステップ

1. **業務フローパターンの確認**: パターンAかパターンBかを確認
2. **診断内容の確認**: 診断時に確認する項目を確認
3. **見積もりの確認**: 見積もりの作成方法を確認
4. **作業実施の確認**: 作業実施の流れを確認
5. **イレギュラー対応の詳細確認**: 追加作業、見積もりの変更、部品の取り寄せ遅延などの具体的な対応方法を確認

---

## 更新履歴

- 2025-01-XX: 初版作成（業務理解ドキュメント）

























