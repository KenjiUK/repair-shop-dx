# その他のメンテナンス系 確認済み仕様書

## ドキュメント情報

- **作成日**: 2025-01-XX
- **バージョン**: 1.0
- **対象**: その他のメンテナンス系（消耗品交換・定期メンテナンス）
- **ステータス**: 実装準備完了
- **注意**: バッテリー交換、ブレーキフルード交換など一般的な消耗系・メンテナンス系を統合管理

---

## 1. 対象メニュー一覧

### 1-1. 統合対象メニュー

以下のメニューを「その他のメンテナンス」として統合管理します：

| メニュー名 | 所要時間 | 頻度 | 特徴 |
|----------|---------|------|------|
| **バッテリー交換** | 30分〜1時間 | 2-5年 | バッテリーの劣化状況を確認して交換 |
| **ブレーキフルード交換** | 30分〜1時間 | 2年 | 安全に関わる重要なメンテナンス |
| **エアフィルター交換** | 15-30分 | 1-2年 | エンジンの吸気フィルター交換 |
| **クーラント（冷却水）交換** | 1-2時間 | 2-3年 | エンジンの冷却システム |
| **スパークプラグ交換** | 1-2時間 | 3-5年 | エンジンの点火プラグ交換 |
| **ベルト類交換** | 1-3時間 | 5-10年 | ファンベルト、タイミングベルトなど |
| **ワイパー交換** | 15-30分 | 1-2年 | フロント・リアワイパー |
| **ブレーキパッド交換** | 1-2時間 | 3-5年 | 安全に関わる重要なメンテナンス |
| **ブレーキローター交換** | 1-2時間 | 5-10年 | ブレーキパッドとセットで交換されることが多い |
| **オイルフィルター交換（単独）** | 15-30分 | オイル交換とセット | オイル交換とセットの場合が多いが、単独もあり |
| **キャビンフィルター交換** | 15-30分 | 1-2年 | エアコンのフィルター交換 |
| **ラジエーターキャップ交換** | 5-10分 | 必要時 | 簡易な交換作業 |

### 1-2. 入庫区分の設定

**入庫区分**: `その他のメンテナンス`

**設計決定**:
- システム上は「その他のメンテナンス」として1つの入庫区分で管理
- 受付時または診断開始時に、具体的なメニュー（バッテリー交換、ブレーキフルード交換など）を選択
- メニュー選択により、診断項目・見積項目・作業項目が動的に変化

---

## 2. 確認済み事項

### 2-1. 業務フローパターン

**重要な気づき**: 
- **パターンA（入庫してから見積もり）**: 入庫→見積もり→承認→作業（車検・12ヶ月点検など）
- **パターンB（事前にメール等で見積もり）**: メール等で見積もり→了承→入庫→作業（エンジンオイル交換、バッテリー交換など）

**その他のメンテナンス系**: ✅ **パターンB（事前にメール等で見積もり→了承→入庫→作業）**

**設計決定**:
- 予約時にメール等で見積もりを送信
- 顧客が了承
- 入庫日を確定
- **部品持ち込みの場合もある**（顧客が自分で部品を用意する場合）
- 入庫当日は作業のみ実施

### 2-2. 業務フロー

#### Phase 0: 予約・事前準備
- **顧客の行動**: 定期メンテナンスの予約、または不具合を感じた時の予約
- **スタッフの行動**: 
  - 前回交換日・走行距離の確認
  - 部品の在庫確認
  - 車両情報の確認（適合部品の特定）
- **システム要件**: 
  - 前回交換履歴の表示
  - 部品在庫の確認
  - 車両情報からの適合部品の自動提案

#### Phase 1: 受付
- **所要時間**: 約3-5分
- **確認事項**: 
  - 走行距離
  - 前回交換日（該当する場合）
  - 不具合の有無（該当する場合）
  - 顧客の要望（部品のグレードなど）
  - **メニューの選択**（バッテリー交換、ブレーキフルード交換など）
- **記録内容**: 
  - 走行距離
  - 顧客の要望事項
  - **選択されたメニュー**

#### Phase 2: 診断・検査（簡易）
- **所要時間**: 約10-30分（メニューによって異なる）
- **検査項目**: 
  - **交換対象部品の状態確認**（メニューに応じて動的に表示）
  - **関連箇所の簡易点検**（必要に応じて）
- **記録内容**: 
  - 交換対象部品の状態
  - 測定値（メニューに応じて）
  - 写真（必要に応じて）

#### Phase 3: 見積作成（簡易）
- **所要時間**: 約5-10分
- **作業内容**: 
  - 部品代・工賃の見積もり
  - 交換方法の説明（必要に応じて）
- **記録内容**: 
  - 部品代・工賃の内訳
  - 交換方法の説明

#### Phase 4: 顧客承認（即決が多い）
- **所要時間**: 通常即決（事前にメール等で了承済みの場合が多い）
- **顧客の行動**: 
  - 見積内容の確認
  - 承認
- **システム要件**: 
  - 簡易な承認フロー

#### Phase 5: 作業実施
- **所要時間**: メニューによって異なる（15分〜3時間）
- **作業内容**: 
  - 交換作業の実施
  - 動作確認
  - 関連箇所の点検（必要に応じて）
- **記録内容**: 
  - 交換した部品の種類・型番
  - 交換部品の記録
  - Before/After写真（必要に応じて）
  - 動作確認の結果

#### Phase 6: 引渡・説明
- **所要時間**: 約5-10分
- **作業内容**: 
  - 交換内容の説明
  - 次回交換時期の案内
  - 注意事項の説明
- **記録内容**: 
  - 引渡日時
  - 次回交換予定日（該当する場合）

### 2-3. 費用

**質問**: その他のメンテナンス系の費用はいくらですか？

**回答**: ✅ **メニューによって異なる。事前にメール等で見積もりを送信済み**

**設計決定**:
- メニューごとに費用が異なる
- 部品代・工賃の内訳を明確に表示
- 事前にメール等で見積もりを送信済みのため、入庫当日は確認のみ

### 2-4. 検査項目

**質問**: その他のメンテナンス系の簡易検査項目は、どのように入力しますか？

**回答**: ✅ **メニューに応じて動的に表示**

**設計決定**:
- **メニュー選択により、検査項目が動的に変化**
- 各メニューに応じた検査項目をリスト形式で表示
- 各項目の状態を選択（正常/注意/要交換）
- 必要に応じて写真撮影

**メニュー別の検査項目例**:

| メニュー | 検査項目 |
|---------|---------|
| **バッテリー交換** | バッテリー電圧、端子の状態、充電状態 |
| **ブレーキフルード交換** | フルードの色、量、汚れ具合、水分含有率 |
| **エアフィルター交換** | フィルターの汚れ具合、目詰まり |
| **クーラント交換** | 冷却水の色、量、汚れ具合、凍結防止性能 |
| **スパークプラグ交換** | プラグの状態、ギャップ、焼け具合 |
| **ベルト類交換** | ベルトのひび割れ、張り具合、摩耗 |
| **ワイパー交換** | ワイパーの劣化状態、拭き取り性能 |
| **ブレーキパッド交換** | パッドの残量、ローターの状態、異音の有無 |
| **ブレーキローター交換** | ローターの摩耗、歪み、スコアリング |

### 2-5. 測定値の入力

**質問**: 測定値の入力は必要ですか？

**回答**: ✅ **メニューによって異なる。必要に応じて入力**

**設計決定**:
- **メニューに応じて、測定値入力フィールドを動的に表示**
- 測定値が必要なメニューのみ、入力フィールドを表示
- 測定値が不要なメニューは、状態選択のみ

**メニュー別の測定値例**:

| メニュー | 測定値 |
|---------|--------|
| **バッテリー交換** | 電圧（V）、CCA（Cold Cranking Amps） |
| **ブレーキフルード交換** | 水分含有率（%）、沸点（℃） |
| **クーラント交換** | 凍結防止性能（℃）、pH値 |
| **スパークプラグ交換** | ギャップ（mm）、抵抗値（Ω） |
| **ベルト類交換** | 張力（N）、ひび割れの本数 |
| **ブレーキパッド交換** | パッド残量（mm）、ローターの厚み（mm） |
| **ブレーキローター交換** | ローターの厚み（mm）、歪み（mm） |
| **ラジエーターキャップ交換** | 圧力（kPa） |

### 2-6. 写真・動画

**質問**: 写真・動画の撮影は必要ですか？

**回答**: ✅ **メニューによって異なる。必要に応じて撮影**

**設計決定**:
- **Before写真**: 交換前の部品の状態を撮影（必要に応じて）
- **After写真**: 交換後の部品の状態を撮影（必要に応じて）
- 動画は不要（写真のみ）
- 顧客への説明材料として有効

**メニュー別の写真撮影例**:

| メニュー | Before写真 | After写真 |
|---------|-----------|-----------|
| **バッテリー交換** | 端子の状態 | 新しいバッテリーの取り付け状態 |
| **ブレーキフルード交換** | フルードの色 | 新しいフルードの色 |
| **エアフィルター交換** | フィルターの汚れ具合 | 新しいフィルター |
| **クーラント交換** | 冷却水の色 | 新しい冷却水の色 |
| **スパークプラグ交換** | プラグの状態 | 新しいプラグ |
| **ベルト類交換** | ベルトの状態 | 新しいベルト |
| **ワイパー交換** | ワイパーの劣化状態 | 新しいワイパー |
| **ブレーキパッド交換** | パッドの残量、ローターの状態 | 新しいパッド、ローターの状態 |
| **ブレーキローター交換** | ローターの状態 | 新しいローター |

### 2-7. 部品リストアップ

**質問**: 診断時の部品リストアップは必要ですか？

**回答**: ✅ **記録は必要だが、部品リストアップは不要**

**設計決定**:
- 診断時の部品リストアップは不要
- 見積作成時に部品を選択・入力
- 作業記録時に交換部品を記録

### 2-8. 見積もり・承認フロー

**質問**: 見積もりの承認フローはどうしますか？

**回答**: ✅ **事前にメール等で見積もり→了承→入庫→作業**

**設計決定**:
- 事前にメール等で見積もりを送信済み
- 顧客が了承済み
- 入庫当日は見積内容の確認のみ
- 承認フローは簡易化（確認のみ）

### 2-9. 作業記録

**質問**: 作業記録はどうすればいいですか？

**回答**: ✅ **メニューに応じて記録**

**設計決定**:
- **交換した部品の種類・型番・数量を記録**
- Before/After写真を記録（必要に応じて）
- 動作確認の結果を記録
- 作業メモを記録（必要に応じて）

### 2-10. データソース

**質問**: 車両情報や費用情報の取得元は車検・12ヶ月点検と同じですか？

**回答**: ✅ **全部一緒です**

**設計決定**:
- 車両情報: Google Sheets「【DB】車両マスタ」の「車両_同期用」シートから取得
- 費用情報: 同じく「車両_同期用」シートから取得（該当する場合）
- 部品情報: 部品マスタから取得（今後実装）

### 2-11. PDF生成

**質問**: PDF生成は必要ですか？

**回答**: ✅ **不要。PDFで出すのは車検と12ヶ月点検のみ**

**設計決定**:
- その他のメンテナンス系ではPDF生成は不要
- 作業記録はシステム内で管理
- 顧客への説明は口頭または画面で実施

---

## 3. 画面設計

### 3-1. 受付画面（Phase 1）

#### メニュー選択UI

**設計**:
- 受付時に「その他のメンテナンス」を選択
- 具体的なメニューを選択（バッテリー交換、ブレーキフルード交換など）
- メニュー選択により、以降の画面が動的に変化

**UI要素**:
- メニュー選択ドロップダウンまたはラジオボタン
- 選択されたメニューの説明表示
- 前回交換履歴の表示（該当する場合）

### 3-2. 診断画面（Phase 2）

#### メニュー別の動的表示

**設計**:
- **メニュー選択により、検査項目が動的に表示**
- 各メニューに応じた検査項目をリスト形式で表示
- 各項目の状態を選択（正常/注意/要交換）
- 測定値入力フィールド（メニューに応じて動的に表示）
- 写真撮影（必要に応じて）

**UI要素**:
- 検査項目リスト（メニューに応じて動的）
- 状態選択ボタン（正常/注意/要交換）
- 測定値入力フィールド（メニューに応じて動的）
- 写真撮影ボタン
- コメント入力欄

### 3-3. 見積画面（Phase 3）

#### メニュー別の動的表示

**設計**:
- **メニュー選択により、見積項目が動的に表示**
- 部品代・工賃の見積もり
- 車両情報から適合部品を自動提案
- 複数のグレードがある場合、選択可能

**UI要素**:
- 部品選択UI（車両情報から適合部品を自動提案）
- グレード選択UI（複数のグレードがある場合）
- 工賃入力欄
- 合計金額表示
- 写真・コメントの紐付け

### 3-4. 作業画面（Phase 4）

#### メニュー別の動的表示

**設計**:
- **メニュー選択により、作業項目が動的に表示**
- 交換作業の実施
- Before/After写真の撮影
- 交換部品の記録
- 動作確認の結果

**UI要素**:
- 作業項目リスト（メニューに応じて動的）
- Before/After写真撮影ボタン
- 交換部品入力欄
- 動作確認チェックボックス
- 作業メモ入力欄

---

## 4. データモデル

### 4-1. メンテナンスメニュー型定義

```typescript
/**
 * メンテナンスメニュー種別
 */
export type MaintenanceType =
  | "バッテリー交換"
  | "ブレーキフルード交換"
  | "エアフィルター交換"
  | "クーラント交換"
  | "スパークプラグ交換"
  | "ベルト類交換"
  | "ワイパー交換"
  | "ブレーキパッド交換"
  | "ブレーキローター交換"
  | "オイルフィルター交換"
  | "キャビンフィルター交換"
  | "ラジエーターキャップ交換";

/**
 * メンテナンスメニュー設定
 */
export interface MaintenanceMenuConfig {
  /** メニュー名 */
  name: MaintenanceType;
  /** 所要時間（分） */
  duration: number;
  /** 検査項目 */
  inspectionItems: InspectionItem[];
  /** 測定値フィールド */
  measurementFields: MeasurementField[];
  /** 写真撮影が必要か */
  requiresPhoto: boolean;
  /** 部品が必要か */
  requiresParts: boolean;
}

/**
 * 検査項目
 */
export interface InspectionItem {
  /** 項目ID */
  id: string;
  /** 項目名 */
  name: string;
  /** カテゴリ */
  category: string;
  /** 必須か */
  required: boolean;
}

/**
 * 測定値フィールド
 */
export interface MeasurementField {
  /** フィールドID */
  id: string;
  /** フィールド名 */
  name: string;
  /** 単位 */
  unit: string;
  /** 必須か */
  required: boolean;
}
```

### 4-2. メンテナンスジョブデータ

```typescript
/**
 * メンテナンスジョブ
 */
export interface MaintenanceJob {
  /** Job ID */
  jobId: string;
  /** 入庫区分 */
  serviceKind: "その他のメンテナンス";
  /** メンテナンスメニュー */
  maintenanceType: MaintenanceType;
  
  /** 診断情報 */
  diagnosis: {
    /** 検査項目の結果 */
    inspectionResults: InspectionResult[];
    /** 測定値 */
    measurements: Record<string, number>;
    /** 写真 */
    photos: Photo[];
    /** コメント */
    comments: string;
  };
  
  /** 見積情報 */
  estimate: {
    /** 部品 */
    parts: Part[];
    /** 工賃 */
    labor: number;
    /** 合計 */
    total: number;
  };
  
  /** 作業情報 */
  work: {
    /** 交換部品 */
    replacedParts: ReplacedPart[];
    /** Before/After写真 */
    photos: Photo[];
    /** 作業メモ */
    workNotes: string;
    /** 動作確認結果 */
    operationCheck: boolean;
  };
}
```

---

## 5. 実装方針

### 5-1. メニュー選択の実装

**設計**:
- 受付時または診断開始時にメニューを選択
- メニュー選択により、以降の画面が動的に変化
- メニュー設定をマスタデータとして管理

### 5-2. 動的UIの実装

**設計**:
- メニュー設定に基づいて、検査項目・測定値フィールド・見積項目・作業項目を動的に表示
- コンポーネントの再利用性を高める
- メニュー追加時の拡張性を考慮

### 5-3. データ管理

**設計**:
- メニュー設定をマスタデータとして管理
- 各メニューの検査項目・測定値フィールドを設定可能に
- 将来的にメニュー追加が容易になる設計

---

## 6. 次のステップ

1. **メニュー選択UIの実装**: 受付時または診断開始時のメニュー選択UI
2. **メニュー設定マスタの作成**: 各メニューの設定をマスタデータとして管理
3. **動的UIの実装**: メニューに応じた診断画面・見積画面・作業画面の動的表示
4. **データモデルの実装**: メンテナンスジョブのデータモデル実装
5. **テスト**: 各メニューでの動作確認

---

## 更新履歴

- 2025-01-XX: 初版作成


























