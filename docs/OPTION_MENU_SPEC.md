# オプションメニュー仕様書

## ドキュメント情報

- **作成日**: 2025-01-XX
- **バージョン**: 1.0
- **対象**: 車検・12ヶ月点検と同時実施で10%割引のオプションメニュー
- **ステータス**: 仕様確定

---

## 1. 概要

車検（法定24ヶ月点検）および12ヶ月点検（法定12ヶ月点検）と同時に実施する場合、以下の8つのオプションメニューを10%割引で提供します。

**割引条件**:
- 車検と同時実施の場合: 10%割引
- 12ヶ月点検と同時実施の場合: 10%割引
- 単独で実施する場合: 通常価格（割引なし）

---

## 2. オプションメニュー一覧

### 2-1. エンジンオイル交換（下抜き）

- **通常価格**: ¥10,560
- **割引価格**: ¥9,504（10%割引）
- **内容**: SM規格全合成油3L使用+レベル点検
- **バッジ**: エンジン保護（緑色）
- **所要時間**: 約1時間
- **備考**: 予約時にオイルフィルターの有無を確認済み、在庫も用意済み

### 2-2. クーラント交換

- **通常価格**: ¥14,740
- **割引価格**: ¥13,266（10%割引）
- **内容**: 冷却水2L交換+冷却系統点検
- **バッジ**: オーバーヒート防止（緑色）
- **所要時間**: 約1時間

### 2-3. バッテリー交換

- **通常価格**: ¥27,500
- **割引価格**: ¥24,750（10%割引）
- **内容**: 標準バッテリー(LN1)+充電系統点検
- **バッジ**: 始動不良を予防（青色）
- **所要時間**: 約1時間

### 2-4. タイヤ交換作業（4本）

- **通常価格**: ¥30,800
- **割引価格**: ¥27,720（10%割引）
- **内容**: バランス調整込(16インチ迄、タイヤ代別)
- **バッジ**: 安全走行の要（緑色）
- **所要時間**: 約1-2時間
- **備考**: タイヤ代は別途必要

### 2-5. ブレーキフルード交換

- **通常価格**: ¥18,590
- **割引価格**: ¥16,731（10%割引）
- **内容**: フルード1L交換+エア抜き作業
- **バッジ**: ブレーキ性能維持（緑色）
- **所要時間**: 約1時間

### 2-6. ブレーキパッド交換

- **通常価格**: ¥30,800
- **割引価格**: ¥27,720（10%割引）
- **内容**: フロント左右交換(パッド代込)
- **バッジ**: 低ダスト対応可（緑色）
- **所要時間**: 約1-2時間

### 2-7. ミッションオイル交換

- **通常価格**: ¥12,540
- **割引価格**: ¥11,286（10%割引）
- **内容**: 高性能ギアオイル2L使用
- **バッジ**: 変速スムーズ（緑色）
- **所要時間**: 約1時間

### 2-8. ATフルード交換作業

- **通常価格**: ¥79,200
- **割引価格**: ¥71,280（10%割引）
- **内容**: 圧送交換(オイル代12L込)
- **バッジ**: AT保護（緑色）
- **所要時間**: 約1-2時間

---

## 3. システム設計

### 3-1. 見積もり画面での表示

**表示位置**: 見積もり画面の「オプションメニュー」セクション

**表示内容**:
- 各オプション項目をカード形式で表示
- 「車検と同時実施で10%割引」または「12ヶ月点検と同時実施で10%割引」のバッジを表示
- 通常価格と割引価格を併記
- 各オプションの詳細説明（内容、バッジ、所要時間など）
- チェックボックスで選択/解除可能

**UI例**:
```
┌─────────────────────────────────────────┐
│ ☐ エンジンオイル交換（下抜き）            │
│    [🎁 車検と同時実施で10%割引]          │
│    SM規格全合成油3L使用+レベル点検        │
│    通常: ¥10,560 → 割引: ¥9,504          │
│    所要時間: 約1時間                      │
│    [詳細を見る]                           │
└─────────────────────────────────────────┘
```

### 3-2. 顧客承認画面での表示

**表示位置**: 顧客承認画面の「オプションメニュー」セクション

**表示内容**:
- 見積もり画面と同様の表示
- 顧客が選択/解除可能
- リアルタイムで合計金額が更新される
- 選択されたオプションは作業画面に表示される

### 3-3. データモデル

```typescript
interface OptionMenuItem {
  id: string;
  name: string;
  description: string;
  originalPrice: number;
  discountedPrice: number; // originalPrice * 0.9
  badge: {
    text: string;
    color: "green" | "blue";
  };
  estimatedTime: string;
  category: "maintenance" | "repair";
}

interface EstimateWithOptions {
  // ... 既存の見積もり項目
  optionMenuItems: OptionMenuItem[];
  selectedOptionMenuItems: string[]; // OptionMenuItem.id[]
}
```

### 3-4. 割引計算ロジック

```typescript
function calculateDiscount(originalPrice: number): number {
  return Math.floor(originalPrice * 0.9);
}

function calculateTotalWithOptions(
  baseTotal: number,
  selectedOptions: OptionMenuItem[]
): number {
  const optionsTotal = selectedOptions.reduce(
    (sum, option) => sum + option.discountedPrice,
    0
  );
  return baseTotal + optionsTotal;
}
```

---

## 4. 業務フロー

### 4-1. 見積もり作成時（フロントスタッフ）

1. 見積もり画面を開く
2. 法定費用を確認（自動取得済み）
3. 診断結果から部品代・工賃の項目を追加
4. **オプションメニューセクションを表示**
   - 8つのオプションメニューを一覧表示
   - 各オプションに「車検と同時実施で10%割引」のバッジを表示
   - フロントスタッフが顧客に提案する項目を選択
5. プレビューで確認
6. 顧客に送信（LINE/メール/SMS）

### 4-2. 顧客承認時

1. 承認画面を開く（LINE/メール/SMSから）
2. 法定費用を確認（必須、編集不可）
3. 推奨整備を選択/解除
4. **オプションメニューを選択/解除**
   - 各オプションに「車検と同時実施で10%割引」のバッジを表示
   - 割引前価格と割引後価格を併記
   - 選択/解除でリアルタイムに合計金額が更新
5. 合計金額を確認
6. 承認

### 4-3. 作業実施時（整備士）

1. 作業画面を開く
2. 承認された項目を確認
3. **承認されたオプションメニューも表示**
   - オプションメニューも作業項目として表示
   - 作業を実施
   - Before/After写真を撮影（必要に応じて）
4. 作業完了

---

## 5. UI/UX設計原則

### 5-1. 視覚的な強調

- **割引バッジ**: 「車検と同時実施で10%割引」または「12ヶ月点検と同時実施で10%割引」のバッジを目立つ色（例: オレンジ、赤）で表示
- **価格表示**: 通常価格に取り消し線を引き、割引価格を大きく表示
- **バッジ表示**: 各オプションの特徴を示すバッジ（エンジン保護、オーバーヒート防止など）を表示

### 5-2. 情報の明確性

- **詳細説明**: 各オプションの内容、所要時間、バッジを明確に表示
- **価格の透明性**: 通常価格と割引価格を併記し、割引額を明示
- **選択の容易さ**: チェックボックスで簡単に選択/解除可能

### 5-3. リアルタイムフィードバック

- **合計金額の更新**: オプションを選択/解除すると、リアルタイムで合計金額が更新される
- **視覚的フィードバック**: 選択されたオプションは背景色を変えるなど、視覚的に分かりやすく表示

---

## 6. データ保存

### 6-1. Zoho CRMへの保存

- **field13 (作業内容)**: 承認されたオプションメニューも含めて、全ての作業項目をテキスト形式で保存
- **例**: 「・車検（24ヶ月）\n・エンジンオイル交換（下抜き）¥9,504\n・クーラント交換¥13,266\n（合計: ¥XXX,XXX）」

### 6-2. 内部DBへの保存

- 承認されたオプションメニューのIDと割引価格を保存
- 作業画面で表示するために使用

---

## 7. 実装優先順位

### Phase 1: MVP（最小限の機能）

1. **オプションメニューの表示**
   - 見積もり画面で8つのオプションメニューを表示
   - 割引価格を計算して表示

2. **選択機能**
   - フロントスタッフがオプションを選択可能
   - 顧客が承認画面で選択/解除可能

3. **合計金額の計算**
   - 選択されたオプションの割引価格を合計に反映

### Phase 2: 拡張機能

1. **詳細表示**
   - 各オプションの詳細説明をモーダルで表示
   - バッジ、所要時間などの情報を表示

2. **推奨機能**
   - 診断結果に基づいて、推奨するオプションを自動表示
   - 例: ブレーキパッドが薄い場合、ブレーキパッド交換を推奨

3. **履歴機能**
   - 過去に実施したオプションメニューの履歴を表示
   - 次回の提案に活用

---

## 8. 注意事項

### 8-1. 割引条件

- **割引は車検・12ヶ月点検と同時実施の場合のみ適用**
- 単独でオプションメニューを実施する場合は通常価格
- 複数のオプションメニューを選択した場合、それぞれに10%割引が適用される

### 8-2. 価格の整合性

- **割引価格は必ず基幹システム（スマートカーディーラー）の価格と一致させる**
- Webアプリ側で独自に価格を計算しない
- 基幹システムから価格を取得し、10%割引を適用

### 8-3. 作業の実施

- **承認されたオプションメニューは、車検・12ヶ月点検と同時に作業を実施**
- 作業画面でオプションメニューも作業項目として表示
- Before/After写真を撮影（必要に応じて）

---

## 9. 関連ドキュメント

- `docs/VEHICLE_INSPECTION_COMPLETE_SPEC.md`: 車検の完全設計仕様書
- `docs/12MONTH_INSPECTION_CONFIRMED_SPEC.md`: 12ヶ月点検の確認済み仕様書
- `docs/ENGINE_OIL_CHANGE_CONFIRMED_SPEC.md`: エンジンオイル交換の確認済み仕様書

---

## 更新履歴

- 2025-01-XX: 初版作成（オプションメニュー仕様書）



































