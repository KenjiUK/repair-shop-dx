# 事前チェックインページのUX改善提案

**作成日:** 2025-01-XX  
**対象ページ:** `/customer/pre-checkin/[id]`  
**レビュー基準:** 
- 既存のWEBアプリの機能・UIUX
- 輸入車整備工場の業務フロー
- UIUXのベストプラクティス
- 顧客目線での使いやすさ

---

## 1. 全体構造の改善提案

### 1-1. コンテナ幅の統一

**現状:**
- `max-w-5xl` (1280px) を使用

**提案:**
- `max-w-4xl` (896px) に変更
- **理由**: 
  - 既存のワークフローページ（TOPページ、診断ページ、顧客承認ページなど）と統一
  - 可読性の向上（約56文字幅で最適）
  - 画面遷移時の視覚的な一貫性を確保

**参照:** `docs/DESIGN_SYSTEM.md` セクション11-6

---

## 2. セクション構成と順番の改善提案

### 2-1. セクション順序の再構成

**現状の順序:**
1. 今回ご入庫のお車（車両選択）
2. お客様情報の確認
3. メール配信について
4. 問診

**提案する順序:**
1. **今回ご入庫のお車**（最重要・最初に確認）
2. **車検証のアップロード**（新規追加・車両選択と密接に関連）
3. **現在の走行距離**（車両と関連する情報）
4. **不具合・気になるところ**（顧客が伝えたい情報）
5. **代車のご希望**（サービスの要望）
6. **お客様情報の確認**（連絡先情報）
7. **メール配信について**（オプション設定）

**理由:**
- 車両情報を最初にまとめる（車両選択 → 車検証 → 走行距離）
- 顧客が伝えたい情報を先に（不具合、代車希望）
- 連絡先情報やオプション設定は後半に配置
- 論理的な情報の流れ: 車両 → 状態・要望 → 連絡先 → 設定

---

## 3. 「問診」という用語について

### 3-1. 用語の検討

**現状:**
- 「問診」という用語を使用

**提案:**
- **「ご要望・お聞かせください」** または **「事前確認事項」** に変更

**理由:**
- 「問診」は医療用語であり、自動車整備の文脈では一般的でない
- 輸入車整備工場では「問診」という用語は使用されない可能性が高い
- 顧客目線では「要望を伝える」「気になることを伝える」という認識
- より親しみやすく、理解しやすい表現

**代替案:**
- 「ご要望・お聞かせください」（推奨）
- 「事前確認事項」
- 「お車の状態について」
- 「お車のご要望」

---

## 4. 車検証アップロード機能の追加

### 4-1. 車検証アップロードの配置

**提案:**
- 車両選択セクションの直後に配置
- **既存車両を選択した場合**でも車検証をアップロードできるようにする

**理由:**
- ユーザーが提案: 「車検証はここでアップしてもらうとよい」
- 車検証は車両情報と密接に関連
- 既存車両でも車検証の更新が必要な場合がある
- 事前チェックインで一括して情報を収集できる

**実装方針:**
- `VehicleRegistrationUpload`コンポーネントを活用
- 既存車両選択時と新規車両登録時の両方で表示
- 任意入力（必須ではない）
- 既存車両の場合: `vehicleId`を使用してアップロード
- 新規車両の場合: 現在の実装通り（車両作成後にリンク設定）

---

## 5. UI/UXの改善提案

### 5-1. セクションタイトルのアイコン統一

**現状:**
- 各セクションで異なるアイコンを使用（Car, CheckCircle2）

**提案:**
- セクションの内容に応じた適切なアイコンを使用
  - 車両選択: `Car` (現状維持)
  - 車検証: `FileText` または `FileCheck`
  - 走行距離: `Gauge` または `Activity`
  - 不具合・要望: `MessageCircle` または `AlertCircle`
  - 代車希望: `Car` または `CarFront`
  - お客様情報: `User` または `Contact`
  - メール配信: `Mail` または `Bell`

### 5-2. セクション間の区切り

**現状:**
- `Separator`コンポーネントを使用

**提案:**
- 現状維持（適切）

### 5-3. フォーム要素のサイズ

**現状:**
- Input: `h-12` (48px) ✅ 適切
- Button: `h-12` (48px) ✅ 適切
- Textarea: 適切なサイズ

**提案:**
- 現状維持（DESIGN_SYSTEM.mdの推奨に準拠）

### 5-4. ラベルとプレースホルダーの改善

**走行距離のラベル:**
- **現状:** 「現在の走行距離（概算）」
- **提案:** 「現在の走行距離」または「現在の走行距離（km）」
- **理由:** 「概算」という表現が不要（顧客は正確な値を入力する）

**不具合・気になるところのラベル:**
- **現状:** 「不具合・気になるところ」
- **提案:** 現状維持（適切）

**プレースホルダーの改善:**
- **走行距離:** 「例: 50000」→ 「50000」または「現在の走行距離を入力」
- **不具合:** 「例: ブレーキから異音がする、エンジンがかかりにくい」→ 現状維持（適切）

### 5-5. バリデーションの追加

**提案:**
- 走行距離: 数値のみ、0以上の値
- 車種名（新規車両）: 必須入力の明確化
- 車検証（新規車両）: 必須ではないが、推奨メッセージを表示

---

## 6. レイアウトとスペーシングの改善

### 6-1. カードのパディング

**現状:**
- `CardContent`のデフォルトパディング

**提案:**
- 適切なパディングを確保（`p-6` 推奨）

### 6-2. セクション間のスペーシング

**現状:**
- `space-y-6` (フォーム全体)
- `space-y-4` (セクション内)

**提案:**
- 現状維持（適切）

---

## 7. エラーハンドリングとユーザーフィードバック

### 7-1. ローディング状態

**現状:**
- ジョブ・顧客・車両データの読み込み中にローディング表示

**提案:**
- 現状維持（適切）

### 7-2. 送信後のフィードバック

**現状:**
- 送信成功後、3秒後にトップページにリダイレクト
- トースト通知で成功メッセージを表示

**提案:**
- 送信成功メッセージを改善:
  - 「事前チェックイン情報を保存しました」
  - → 「事前チェックイン情報を送信しました。ありがとうございます。」
- リダイレクト前の待機時間を5秒に延長（ユーザーがメッセージを読めるように）

---

## 8. アクセシビリティの改善

### 8-1. フォーカス管理

**提案:**
- フォーム送信後、成功メッセージにフォーカス
- エラー発生時、エラーメッセージにフォーカス

### 8-2. ラベルと入力フィールドの関連付け

**現状:**
- `Label`コンポーネントの`htmlFor`属性を使用 ✅ 適切

**提案:**
- 現状維持（適切）

---

## 9. モバイル対応の確認

### 9-1. レスポンシブデザイン

**確認事項:**
- フォーム要素が適切なサイズか（48px以上）
- テキストが読みやすいか（16px以上）
- ボタンがタップしやすいか（48px×48px以上）

**提案:**
- 現状の実装を確認し、必要に応じて調整

---

## 10. 実装優先度

### 🔴 高優先度（必須）

1. **コンテナ幅の統一** (`max-w-4xl`に変更)
2. **「問診」という用語の変更**（「ご要望・お聞かせください」に変更）
3. **セクション順序の再構成**（論理的な順序に変更）
4. **車検証アップロード機能の追加**（既存車両選択時も表示）

### 🟡 中優先度（推奨）

5. セクションタイトルのアイコン統一
6. ラベルとプレースホルダーの改善
7. 送信後のフィードバック改善
8. バリデーションの追加

### 🟢 低優先度（将来実装）

9. アクセシビリティの改善（フォーカス管理）
10. モバイル対応の詳細確認

---

## 11. 実装時の注意事項

### 11-1. 既存コンポーネントの活用

- `VehicleRegistrationUpload`コンポーネントを活用
- `AppHeader`コンポーネントの使用を検討（現在は使用していない）

### 11-2. データ保存の順序

- 車両選択 → 車検証アップロード → その他の情報
- 既存車両選択時の車検証アップロードは`uploadVehicleRegistration`関数を使用

### 11-3. エラーハンドリング

- 各API呼び出しでエラーハンドリングを適切に実装
- ユーザーに分かりやすいエラーメッセージを表示

---

## 12. 参考資料

- `docs/DESIGN_SYSTEM.md` - デザインシステムの詳細
- `docs/PRE_CHECKIN_IMPLEMENTATION_STATUS.md` - 実装状況
- `src/components/features/vehicle-registration-upload.tsx` - 車検証アップロードコンポーネント
- `src/lib/vehicle-registration-upload.ts` - 車検証アップロード機能

---

## 13. 次回レビュー時の確認事項

1. 実装後のUI/UXの動作確認
2. モバイル端末での表示確認
3. 実際の業務フローでの使用感確認
4. 顧客からのフィードバック収集

