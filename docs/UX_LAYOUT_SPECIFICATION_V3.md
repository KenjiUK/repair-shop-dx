# UXレイアウト仕様書 - カードセクション分割（最終版）

## レイアウト構造

```
┌─────────────────────────────────────────────────────────┐
│ ジョブカード全体                                        │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 【上部セクション】                                  │ │
│ │ ┌──────────┐ ┌──────────────────┐ ┌──────────────┐ │ │
│ │ │          │ │ 顧客名: 山田 雄一│ │ ステータス    │ │ │
│ │ │ 車両画像 │ │ 車両: ポルシェ   │ │ バッジ       │ │ │
│ │ │          │ │ サービス: 車検   │ │ [引渡しを    │ │ │
│ │ │          │ │ 入庫日時、タグ   │ │  開始]       │ │ │
│ │ │          │ │ 担当者、代車     │ │              │ │ │
│ │ │          │ │ 承認済み作業内容 │ │              │ │ │
│ │ │          │ │ 受付メモ追加     │ │              │ │ │
│ │ │          │ │ 顧客向けリンク   │ │              │ │ │
│ │ │          │ │ 変更申請アラート │ │              │ │ │
│ │ └──────────┘ └──────────────────┘ └──────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 【下部セクション（折りたたみ可能）】                │ │
│ │ ┌────────────────────────────────────────────────┐ │ │
│ │ │ [▼] 作業一覧 (2件)                            │ │ │
│ │ └────────────────────────────────────────────────┘ │ │
│ │                                                     │ │
│ │ （展開時）                                         │ │
│ │ ┌────────────────────────────────────────────────┐ │ │
│ │ │ 作業カード1: 車検        [作業を開始 >]       │ │ │
│ │ │ ステータス: 作業中                            │ │ │
│ │ └────────────────────────────────────────────────┘ │ │
│ │ ┌────────────────────────────────────────────────┐ │ │
│ │ │ 作業カード2: 板金・塗装  [診断を開始]         │ │ │
│ │ │ ステータス: 外注調整中                          │ │ │
│ │ └────────────────────────────────────────────────┘ │ │
│ │ (スクロール可能)                                   │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

---

## 仕様詳細

### 1. 上部セクション（顧客情報・車両情報 + 車両画像）

**レイアウト**: 横並び（Flexbox）
- **左側**: 車両画像（固定幅、例：240px）
- **中央**: 顧客情報・車両情報（可変幅）
- **右側**: ステータスバッジ + 受付/引渡しボタン（固定幅、例：200px）

**表示内容**:
- **左側（車両画像）**:
  - 車両写真（またはメーカーアイコン）
  - 写真枚数バッジ（該当する場合）

- **中央（顧客情報・車両情報）**:
  - 顧客名（クリック可能: 顧客詳細ダイアログ）
  - 車両情報（クリック可能: 車両詳細ダイアログ）
  - サービス種類バッジ
  - 入庫日時、タグ、担当者、代車情報
  - 承認済み作業内容ボタン
  - 受付メモ追加ボタン
  - 顧客向けリンク（事前問診、見積承認）
  - 変更申請アラート（該当する場合）

- **右側（ステータス + アクション）**:
  - ステータスバッジ（例: 出庫待ち）
  - 受付開始ボタン（入庫待ちの場合のみ）
  - 引渡しを開始ボタン（出庫待ちの場合のみ）

**特徴**:
- 固定表示（スクロールしない）
- 車両画像は上部セクション内のみに表示

---

### 2. 下部セクション（作業カード一覧）

**レイアウト**: 全幅、折りたたみ可能

**表示内容**:
- **折りたたみボタン**:
  - 「[▼] 作業一覧 (N件)」ボタン
  - デフォルトでは閉じている
  - クリックで展開/折りたたみ

- **展開時の内容**:
  - 作業カード一覧（単発作業でも表示）
  - 各作業カードには以下を表示:
    - **左側**: 作業名、ステータス
    - **右側**: アクションボタン（例: 作業を開始、診断を開始）

**特徴**:
- デフォルトでは閉じている
- クリックで展開/折りたたみ可能
- 展開時はスクロール可能（`max-height`を設定）
- 作業が増えても画面が拡大しない
- 各作業カードは独立して操作可能
- 上部セクションとは視覚的に分離（ボーダーなど）

---

## UI/UXの考慮事項

### 1. 折りたたみ機能のメリット

- **画面のすっきり感**: デフォルトで閉じることで、主要情報（顧客情報・車両情報）が目立つ
- **情報の階層化**: 上部セクションが主要情報、下部セクションが詳細情報として明確に分離
- **操作性**: 必要な時だけ展開できるため、操作が直感的

### 2. ボタンを右側に配置するメリット

- **視認性**: ボタンが右側に統一されることで、操作が分かりやすい
- **操作性**: 右利きユーザーにとって操作しやすい
- **一貫性**: 右上の受付/引渡しボタンと同じ位置に統一感がある

### 3. デフォルトで閉じる理由

- **情報過多の回避**: 作業が多い場合でも、最初は主要情報に集中できる
- **画面の高さ**: カードが縦に長くなりすぎない
- **段階的な情報提示**: まずは概要を確認し、必要に応じて詳細を展開

---

## 実装方針

### レイアウト構造の変更

1. **ジョブカード全体を2つのセクションに分割**:
   ```tsx
   <div className="bg-white rounded-xl border border-slate-200 mb-4 overflow-hidden">
     {/* 上部セクション: 車両画像 + 顧客情報 + 右上アクション */}
     <div className="flex border-b border-slate-200">
       {/* 左側: 車両画像 */}
       <div className="w-[240px] flex-shrink-0">
         {/* 車両画像 */}
       </div>
       
       {/* 中央: 顧客情報・車両情報 */}
       <div className="flex-1 p-4 lg:p-5">
         {/* 顧客名、車両情報、各種ボタン、アラート */}
       </div>
       
       {/* 右側: ステータス + アクション */}
       <div className="w-[200px] flex-shrink-0 p-4 border-l border-slate-200">
         {/* ステータスバッジ、受付/引渡しボタン */}
       </div>
     </div>
     
     {/* 下部セクション: 作業カード一覧（折りたたみ可能） */}
     <div className="border-t border-slate-200">
       <Collapsible defaultOpen={false}>
         <CollapsibleTrigger asChild>
           <Button variant="ghost" className="w-full justify-between h-12">
             <span>作業一覧 ({workOrders.length}件)</span>
             <ChevronDown className="h-5 w-5" />
           </Button>
         </CollapsibleTrigger>
         <CollapsibleContent>
           <div className="p-4 max-h-[400px] overflow-y-auto">
             {/* 作業カード一覧 */}
             {workOrders.map((workOrder) => (
               <div className="flex items-center justify-between p-3 border rounded-lg">
                 <div>
                   {/* 作業名、ステータス */}
                 </div>
                 <div>
                   {/* アクションボタン（右側） */}
                 </div>
               </div>
             ))}
           </div>
         </CollapsibleContent>
       </Collapsible>
     </div>
   </div>
   ```

2. **作業カードのレイアウト**:
   - 左側: 作業名、ステータス
   - 右側: アクションボタン

3. **折りたたみ機能**:
   - デフォルトでは閉じている（`defaultOpen={false}`）
   - クリックで展開/折りたたみ可能

---

## 実装チェックリスト

- [ ] ジョブカード全体を2つのセクションに分割
- [ ] 上部セクション: 車両画像 + 顧客情報 + 右上アクション
- [ ] 下部セクション: 作業カード一覧（折りたたみ可能、デフォルトで閉じる）
- [ ] 作業カードのボタンを右側に配置
- [ ] 折りたたみボタンを追加
- [ ] 視覚的な分離（ボーダー）を追加
- [ ] レスポンシブ対応を確認


