# UX 深堀りレビュー - 業界ベストプラクティスに基づく改善提案

## 現在の実装の問題点

### 1. 複合作業時の表示が複雑で直感的でない

**現在の動作:**
- 受付前: 右上に「受付を開始」ボタンが表示される（OK）
- 受付後: 右上のアクションボタンが消え、「作業一覧を表示 (N件)」ボタンが表示される
- ユーザーは「作業一覧を表示」をクリックしないと作業が見えない

**問題点:**
- 次のアクションが不明確
- クリック数が増える（展開が必要）
- 複合作業の状態が一目でわからない

### 2. 作業カードが展開可能になっている

**現在の動作:**
- 複合作業の場合、作業カードが折りたたまれている
- 「作業一覧を表示」ボタンをクリックしないと見えない

**問題点:**
- 重要な情報（作業の状態）が隠れている
- ユーザーが能動的に展開する必要がある
- 複合作業の全体像が把握しにくい

### 3. アクションボタンの表示ロジックが複雑

**現在の条件:**
```typescript
{((job.field5 === "入庫待ち" || !job.field5) || (!workOrders || workOrders.length <= 1)) && (
  // アクションボタン
)}
```

**問題点:**
- 条件分岐が複雑で理解しにくい
- 受付前/受付後、単体/複合で異なる動作
- ユーザーが「なぜボタンが出ないのか」を理解しにくい

---

## 業界のベストプラクティス

### 1. 常に次のアクションが明確であるべき
- ユーザーは「次に何をすべきか」を一目で理解できるべき
- ボタンが消えたり、展開が必要なのは避けるべき

### 2. 重要な情報は常に表示されるべき
- 複合作業の場合、各作業の状態は常に見えるべき
- 折りたたみは補助的な情報に限定すべき

### 3. クリック数は最小限であるべき
- 1クリックで次のアクションに進めるべき
- 展開→選択→遷移のような多段階操作は避けるべき

### 4. 車両単位の操作と作業単位の操作を明確に分離
- **車両単位**: 受付開始、引き渡し（全作業完了時のみ）
- **作業単位**: 診断開始、作業開始、見積確認

---

## 改善提案

### 提案A: 作業カードを常に表示（推奨）

**コンセプト:**
- 複合作業の場合、作業カードを常に表示（展開不要）
- 各作業カードに直接アクションボタンを表示
- 受付開始ボタンは常に右上に表示（車両単位の操作）

**UI構成:**
```
┌─────────────────────────────────────────┐
│ ジョブカード                            │
│ ┌─────────────────────────────────────┐ │
│ │ 顧客情報・車両情報                   │ │
│ │ ステータス: 入庫済み                │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ ┌─────────────────────────────────────┐ │
│ │ 作業1: 車検                          │ │
│ │ ステータス: 診断中                  │ │
│ │ [診断を開始] ボタン                 │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ ┌─────────────────────────────────────┐ │
│ │ 作業2: 板金・塗装                    │ │
│ │ ステータス: 外注調整中              │ │
│ │ [診断を開始] ボタン                 │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ ┌─────────────────────────────────────┐ │
│ │ [受付を開始] ボタン（右上）          │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

**メリット:**
- 複合作業の状態が一目でわかる
- 各作業に直接アクセスできる
- クリック数が最小限
- 直感的で使いやすい

**デメリット:**
- ジョブカードが大きくなる（複合作業が多い場合）
- スクロールが必要になる可能性

---

### 提案B: 作業カードを折りたたみ可能にする（現状の改善版）

**コンセプト:**
- デフォルトで展開されている
- 折りたたみは可能だが、デフォルトは展開
- 各作業カードに直接アクションボタンを表示

**UI構成:**
```
┌─────────────────────────────────────────┐
│ ジョブカード                            │
│ ┌─────────────────────────────────────┐ │
│ │ 顧客情報・車両情報                   │ │
│ │ ステータス: 入庫済み                │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ ┌─────────────────────────────────────┐ │
│ │ [▼] 作業一覧 (2件)                  │ │
│ │ ┌─────────────────────────────────┐ │ │
│ │ │ 作業1: 車検                      │ │ │
│ │ │ ステータス: 診断中              │ │ │
│ │ │ [診断を開始] ボタン             │ │ │
│ │ └─────────────────────────────────┘ │ │
│ │ ┌─────────────────────────────────┐ │ │
│ │ │ 作業2: 板金・塗装                │ │ │
│ │ │ ステータス: 外注調整中          │ │ │
│ │ │ [診断を開始] ボタン             │ │ │
│ │ └─────────────────────────────────┘ │ │
│ └─────────────────────────────────────┘ │
│                                          │
│ ┌─────────────────────────────────────┐ │
│ │ [受付を開始] ボタン（右上）          │ │
│ └─────────────────────────────────────┘ │
└─────────────────────────────────────────┘
```

**メリット:**
- デフォルトで展開されているため、状態が一目でわかる
- 折りたたみ可能なので、画面スペースを節約できる
- 各作業に直接アクセスできる

**デメリット:**
- 折りたたみボタンが追加のUI要素になる
- デフォルト展開でも、折りたたみ機能があることがわかりにくい可能性

---

## 推奨案: 提案A（作業カードを常に表示）

### 理由

1. **直感的で使いやすい**
   - 複合作業の状態が一目でわかる
   - 展開操作が不要で、クリック数が最小限

2. **業界のベストプラクティスに合致**
   - 重要な情報（作業の状態）は常に表示
   - 次のアクションが明確

3. **実装がシンプル**
   - 折りたたみ機能が不要
   - 条件分岐が少なく、保守しやすい

### 実装方針

1. **複合作業の場合、作業カードを常に表示**
   - 展開不要
   - 各作業カードに直接アクションボタンを表示

2. **受付開始ボタンは常に右上に表示**
   - 車両単位の操作として明確に分離
   - 受付前のみ有効（受付後は無効化または非表示）

3. **単体作業の場合は従来通り**
   - 右上にアクションボタンを表示
   - 作業カードは表示しない

---

## 実装チェックリスト

- [ ] 複合作業の場合、作業カードを常に表示（展開不要）
- [ ] 各作業カードに直接アクションボタンを表示
- [ ] 受付開始ボタンは常に右上に表示（受付前のみ有効）
- [ ] 単体作業の場合は従来通り右上にアクションボタンを表示
- [ ] 作業カードの表示条件を明確化
- [ ] アクションボタンの表示ロジックを簡素化


