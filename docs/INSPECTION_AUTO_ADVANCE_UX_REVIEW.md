# 自動進行機能 UI/UXレビューとベストプラクティス

**作成日**: 2025-01-XX  
**目的**: 整備項目の自動進行機能（Auto-Advance）のレビューとベストプラクティス提案

---

## 📋 現状の仕様レビュー

### 現在の実装の課題

1. **手動操作が必要**
   - 各項目をタップ → ボトムシートを開く → ステータスを選択 → ボトムシートが閉じる
   - 次の項目へ自動スクロールはされるが、その項目のボトムシートは開かない
   - ユーザーは再度タップしてボトムシートを開く必要がある

2. **作業の流れが途切れる**
   - 連続入力時に操作が途切れ、リズムが生まれない
   - 入力速度が低下する

3. **操作回数が多い**
   - 1項目あたり: タップ（開く）→ 選択 → （次の項目を）タップ（開く）→ 選択...
   - 38項目（12ヶ月点検）の場合、約76回のタップ操作

---

## 🔍 ベストプラクティス調査

### 類似アプリのパターン

1. **医療・検査アプリ（例: 健康診断アプリ）**
   - ✅ 質問に回答すると、自動で次の質問が表示される
   - ✅ 連続入力が可能
   - ✅ 作業効率が大幅に向上

2. **フォームアプリ（例: Google Forms）**
   - ✅ 1つのフィールドを入力すると、自動で次のフィールドにフォーカス
   - ✅ キーボード操作が最小限

3. **チェックリストアプリ（例: Todoist、TickTick）**
   - ✅ アイテムをチェックすると、次のアイテムが自動で表示される
   - ✅ 連続チェックが可能

### 業界標準パターン

**Auto-Advance Pattern（自動進行パターン）**

```
ユーザーアクション → 入力完了 → 自動で次の項目へ進行 → 自動で入力UIを開く
```

**メリット:**
- ✅ 操作回数の削減（約50%削減）
- ✅ 作業効率の向上
- ✅ リズムが生まれ、集中力が持続
- ✅ エラーの減少（操作が減ることで）

**デメリットと対策:**
- ⚠️ 誤操作のリスク → ボトムシートを開く前に少し遅延を入れる（100-200ms）
- ⚠️ ユーザーが確認したい場合 → 設定で無効化できるようにする（将来的に）

---

## 💡 改善提案

### 1. 自動進行機能の実装

**フロー:**
1. ユーザーがステータスを選択
2. ボトムシートが閉じる（アニメーション）
3. 次の未完了項目へ自動スクロール
4. **自動で次の項目のボトムシートを開く**（新規）

**実装方針:**
- 次の項目のIDを追跡
- `InspectionBottomSheetItemCard`に`shouldAutoOpen` propを追加
- `useEffect`で`shouldAutoOpen`が`true`になったらボトムシートを開く
- タイミング: ボトムシートが閉じてから200-300ms後

### 2. アニメーションの最適化

**タイミング調整:**
- ボトムシートが閉じる: 300ms
- スクロールアニメーション: 150-200ms
- 次のボトムシートを開く: 200ms後（スクロール完了後）

**合計: 約500-700ms**

### 3. ユーザーエクスペリエンスの向上

**視覚的フィードバック:**
- 現在の項目がハイライト（スクロール時）
- 次の項目が自動で開くことを示す（微細なアニメーション）

**アクセシビリティ:**
- スクリーンリーダー対応（「次の項目に進みました」などのアナウンス）
- キーボード操作対応（将来的に）

---

## 📐 実装設計

### コンポーネント構造

```typescript
InspectionBottomSheetList
├── 次の項目IDを追跡（nextItemIdToAutoOpen）
├── ステータス変更後:
│   ├── onStatusChange(itemId, status)
│   ├── scrollToNext(itemId)
│   └── setNextItemIdToAutoOpen(nextItemId) // 新しい
└── InspectionBottomSheetItemCard
    ├── shouldAutoOpen={nextItemIdToAutoOpen === item.id}
    └── useEffect(() => {
          if (shouldAutoOpen) {
            setIsBottomSheetOpen(true);
            setNextItemIdToAutoOpen(null); // リセット
          }
        })
```

### 状態管理

```typescript
// InspectionBottomSheetList
const [nextItemIdToAutoOpen, setNextItemIdToAutoOpen] = useState<string | null>(null);

// ステータス変更後
const handleStatusChange = (itemId: string, status: InspectionStatus) => {
  onStatusChange(itemId, status);
  
  // 次の項目を探す
  const nextItem = getNextIncompleteItem(itemId);
  
  if (nextItem) {
    // スクロール
    scrollToNext(itemId);
    
    // 次の項目のボトムシートを開く（少し遅延）
    setTimeout(() => {
      setNextItemIdToAutoOpen(nextItem.id);
    }, 500); // ボトムシートが閉じてスクロールが完了してから
  }
};
```

---

## 🎯 期待される効果

### 操作回数の削減

**改善前:**
- 1項目あたり: 2回タップ（開く + 選択）
- 38項目: 約76回のタップ

**改善後:**
- 1項目あたり: 1回タップ（選択のみ）
- 38項目: 約38回のタップ
- **削減率: 約50%**

### 作業時間の短縮

- 1タップあたり約0.5秒と仮定
- 38項目 × 0.5秒 = 19秒の削減
- **作業効率: 約2倍の向上**

### ユーザーエクスペリエンスの向上

- ✅ 連続入力が可能
- ✅ リズムが生まれ、集中力が持続
- ✅ エラーが減少（操作が減ることで）

---

## 🚀 実装優先度

**高優先度:**
1. ✅ 自動進行機能の基本実装
2. ✅ アニメーションのタイミング調整
3. ✅ 次の項目の自動検出

**中優先度（将来の拡張）:**
- 設定で自動進行を無効化できるようにする
- キーボード操作対応
- スクリーンリーダー対応の強化

---

## 📝 まとめ

自動進行機能を実装することで、以下の改善が期待されます：

1. ✅ **操作回数の削減**: 約50%削減
2. ✅ **作業効率の向上**: 約2倍
3. ✅ **ユーザーエクスペリエンスの向上**: 連続入力が可能

**推奨: 即座に実装すべき機能**





