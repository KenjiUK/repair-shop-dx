# コーティング 確認済み仕様書

## ドキュメント情報

- **作成日**: 2025-01-XX
- **バージョン**: 1.0
- **対象**: コーティングの確認済み仕様
- **ステータス**: 実装準備完了

---

## 1. 確認済み事項

### 1-1. コーティングの種類

**質問**: どのようなコーティングの種類があるか？

**回答**: ✅ **ガラスコーティング（3種類）**

**詳細**:
- **ハイモースコート エッジ**: 参考価格 ¥88,000～
- **ハイモースコート グロウ**: 参考価格 ¥88,000～
- **ガードグレイズ**: ¥81,400～
- **車両の寸法によって金額が違う**

**設計決定**:
- システム上は「コーティング」として1つの入庫区分で管理
- 受付時または診断開始時に、具体的な種類（ハイモースコート エッジ、ハイモースコート グロウ、ガードグレイズ）を選択
- 車両の寸法に応じて金額が変動する仕組みを実装

### 1-2. オプションサービス

**質問**: オプションサービスはあるか？

**回答**: ✅ **7種類のオプションサービスあり、同時施工で10％割引**

**詳細**:
- **ホイールコーティング（4本セット）**: ¥26,400 → ¥23,760（同時施工時）
- **ウィンドウ撥水（フロント三面）**: ¥25,000 → ¥22,500（同時施工時）
- **ヘッドライト研磨・クリアコート（左右2個）**: ¥66,000 → ¥59,400（同時施工時）
- **インテリアクリーニング**: ¥39,000 → ¥35,100（同時施工時）
- **バンパーコート（1本）**: ¥15,000 → ¥13,500（同時施工時）
- **ウィンドウフィルム（1面、前面・前側面不可）**: ¥24,000 → ¥21,600（同時施工時）
- **幌コーティング**: ¥48,000 → ¥43,200（同時施工時）

**設計決定**:
- オプションサービスは見積画面で選択可能
- 同時施工の場合、自動で10％割引を適用
- オプションごとに個別に承認・却下を選択可能

### 1-3. 業務フローパターン

**質問**: 業務フローパターンについて

**回答**: ✅ **パターンB（事前見積→承認→入庫→作業）**

**詳細**:
- **事前に見積もりを送って了承して入庫する作業だけのパターン**
- 入庫前に見積もりを提示し、顧客の承認を得てから入庫
- 入庫後は作業のみ実施

**設計決定**:
- パターンB（事前見積→承認→入庫→作業）を採用
- 事前見積画面を実装
- 承認後に入庫処理を行う

### 1-4. 下地処理

**質問**: 研磨や傷補修は別料金か、コーティング費用に含まれるか？

**回答**: ✅ **コーティング費用に含まれる**

**設計決定**:
- 下地処理（研磨・傷補修）はコーティング費用に含まれる
- 見積画面では下地処理費用を別途表示しない

### 1-5. コーティング範囲

**質問**: ボディ全体のみか、ガラス面のコーティングも含むか？

**回答**: ✅ **ボディ全体が基本、ガラス面はオプション**

**詳細**:
- **基本**: ボディ全体のコーティング
- **オプション**: ウィンドウ撥水（フロント三面）、ウィンドウフィルム（1面）

**設計決定**:
- 基本コーティングはボディ全体
- ガラス面のコーティングはオプションとして選択可能

### 1-6. 乾燥時間

**質問**: 乾燥時間はどの程度か？顧客は車を預ける必要があるか？

**回答**: ✅ **数日預ける**

**設計決定**:
- 乾燥時間は数日かかるため、顧客は車を預ける必要がある
- 作業完了まで数日かかることを見積時に明示
- ステータス管理で「乾燥中」などの状態を管理

### 1-7. メンテナンス

**質問**: コーティング後のメンテナンス方法や効果の持続期間は？

**回答**: ✅ **1年から3年**

**設計決定**:
- 効果の持続期間は1年から3年
- 引渡時にメンテナンス方法を説明
- 次回コーティング時期のリマインド機能（将来実装）

### 1-8. PDF生成

**質問**: コーティングでもPDFを生成するか？

**回答**: ✅ **不要。PDFで出すのは車検と12ヶ月点検のみ**

**設計決定**:
- コーティングではPDF生成は不要
- 作業記録はシステム内で管理

---

## 2. 確定した仕様サマリー

### 2-1. 入庫区分の設定

**入庫区分**: `コーティング`

**設計決定**:
- システム上は「コーティング」として1つの入庫区分で管理
- 受付時または診断開始時に、具体的な種類（ハイモースコート エッジ、ハイモースコート グロウ、ガードグレイズ）を選択

### 2-2. 業務フロー（パターンB）

```
1. 予約: コーティング希望の予約
2. 事前見積: 車両の寸法を確認し、見積もりを作成（30分-1時間）
3. 顧客承認: 見積内容を確認して承認
4. 入庫: 承認後に車両を入庫（5-10分）
5. 作業実施: 洗車・下地処理・コーティング剤塗布・乾燥・仕上げ（数日）
6. 引渡・説明: コーティング内容を説明して引渡（15-30分）
```

### 2-3. コーティングの種類

**基本コーティング（3種類）**:
- **ハイモースコート エッジ**: 参考価格 ¥88,000～（車両の寸法によって金額が変動）
- **ハイモースコート グロウ**: 参考価格 ¥88,000～（車両の寸法によって金額が変動）
- **ガードグレイズ**: ¥81,400～（車両の寸法によって金額が変動）

**オプションサービス（7種類、同時施工で10％割引）**:
- ホイールコーティング（4本セット）
- ウィンドウ撥水（フロント三面）
- ヘッドライト研磨・クリアコート（左右2個）
- インテリアクリーニング
- バンパーコート（1本）
- ウィンドウフィルム（1面、前面・前側面不可）
- 幌コーティング

### 2-4. 検査項目

**設計決定**:
- 車体の状態確認（傷・キズ、汚れ、コーティング可能箇所）
- 車両の寸法確認（金額計算用）
- 既存コーティングの状態確認（既にコーティング済みの場合）

### 2-5. 写真撮影

**設計決定**:
- Before/After写真を撮影（必須）
- 車体全体（前・後・左・右）
- 傷・キズ箇所の接写
- コーティング後の状態
- 効果の確認（撥水性など）

### 2-6. 測定値

**設計決定**:
- 車両の寸法（金額計算用）
- 作業時間の記録

### 2-7. PDF生成

**設計決定**:
- コーティングではPDF生成は不要
- 作業記録はシステム内で管理

### 2-8. データソース

**設計決定**:
- 車両情報: Google Sheets「【DB】車両マスタ」の「車両_同期用」シートから取得
- 車両の寸法情報も同シートから取得（金額計算用）

---

## 3. 画面設計

### 3-1. 事前見積画面（Phase 0-3）

#### 車両情報の確認と見積作成

**設計**:
- 車両の寸法を確認
- コーティングの種類を選択（ハイモースコート エッジ、ハイモースコート グロウ、ガードグレイズ）
- オプションサービスを選択（同時施工で10％割引）
- 見積金額を自動計算
- 顧客に送信

**UI要素**:
- 車両情報表示（車名、寸法など）
- コーティング種類選択（ラジオボタンまたはドロップダウン）
- オプションサービス選択（チェックボックス、同時施工で10％割引を自動適用）
- 見積金額表示（自動計算）
- 送信ボタン

### 3-2. 受付画面（Phase 1）

#### 入庫処理

**設計**:
- 承認済みの見積内容を確認
- 走行距離を入力
- 前回コーティング履歴の表示

**UI要素**:
- 承認済み見積内容の表示
- 走行距離入力欄
- 前回コーティング履歴表示

### 3-3. 診断画面（Phase 2）

#### 車体の状態確認

**設計**:
- 車体の状態確認（傷・キズ、汚れ、コーティング可能箇所）
- 車両の寸法確認（金額計算用）
- 既存コーティングの状態確認（既にコーティング済みの場合）
- Before写真撮影

**UI要素**:
- 車体の状態確認チェックリスト
- 傷・キズの位置・程度入力
- 車両の寸法確認（表示のみ、金額計算用）
- Before写真撮影ボタン
- コメント入力欄

### 3-4. 作業画面（Phase 5）

#### 作業記録

**設計**:
- 実施した作業の記録
- Before/After写真の撮影
- 使用したコーティング剤の記録
- 作業時間の記録

**UI要素**:
- 作業記録入力欄
- Before/After写真撮影ボタン
- 使用したコーティング剤入力欄
- 作業時間入力欄
- 作業メモ入力欄

---

## 4. データモデル

### 4-1. コーティングジョブデータ

```typescript
/**
 * コーティングジョブ
 */
export interface CoatingJob {
  /** Job ID */
  jobId: string;
  /** 入庫区分 */
  serviceKind: "コーティング";
  /** コーティングの種類 */
  coatingType: "ハイモースコート エッジ" | "ハイモースコート グロウ" | "ガードグレイズ";
  
  /** 車両情報 */
  vehicle: {
    /** 車両ID */
    vehicleId: string;
    /** 車両の寸法（金額計算用） */
    dimensions?: string;
    /** 走行距離 */
    mileage: number;
  };
  
  /** 事前見積情報 */
  preEstimate: {
    /** コーティングの種類 */
    coatingType: "ハイモースコート エッジ" | "ハイモースコート グロウ" | "ガードグレイズ";
    /** 基本コーティング金額 */
    basePrice: number;
    /** 選択されたオプション */
    selectedOptions: CoatingOption[];
    /** オプション合計金額（10％割引適用後） */
    optionsTotal: number;
    /** 合計金額 */
    total: number;
    /** 承認日時 */
    approvedAt?: Date;
  };
  
  /** 診断情報 */
  diagnosis: {
    /** 車体の状態確認結果 */
    bodyCondition: BodyConditionCheck[];
    /** 傷・キズの位置・程度 */
    scratches: ScratchInfo[];
    /** 既存コーティングの状態 */
    existingCoating?: ExistingCoatingInfo;
    /** Before写真 */
    beforePhotos: Photo[];
    /** コメント（整備士の所見） */
    comments: string;
  };
  
  /** 作業情報 */
  work: {
    /** 実施した作業の記録 */
    workRecords: WorkRecord[];
    /** Before/After写真 */
    photos: Photo[];
    /** 使用したコーティング剤 */
    coatingMaterials: CoatingMaterial[];
    /** 作業時間 */
    workDuration: number;
    /** 作業メモ */
    notes: string;
  };
  
  /** ステータス */
  status: "事前見積作成待ち" | "顧客承認待ち" | "入庫待ち" | "診断中" | "作業待ち" | "作業中" | "乾燥中" | "出庫待ち";
}

/**
 * コーティングオプション
 */
export interface CoatingOption {
  /** オプションID */
  id: string;
  /** オプション名 */
  name: string;
  /** 通常価格 */
  regularPrice: number;
  /** 同時施工価格（10％割引） */
  simultaneousPrice: number;
  /** 選択済みか */
  selected: boolean;
}

/**
 * 車体の状態確認
 */
export interface BodyConditionCheck {
  /** 箇所 */
  location: string;
  /** 状態 */
  condition: "良好" | "軽微な傷" | "中程度の傷" | "深刻な傷" | "汚れあり" | "コーティング残存";
  /** 写真 */
  photo?: Photo;
  /** コメント */
  comment?: string;
}

/**
 * 傷・キズ情報
 */
export interface ScratchInfo {
  /** 位置 */
  position: string;
  /** 程度 */
  severity: "軽微" | "中程度" | "深刻";
  /** 写真 */
  photo: Photo;
  /** コメント */
  comment?: string;
}

/**
 * 既存コーティング情報
 */
export interface ExistingCoatingInfo {
  /** 既存コーティングの種類 */
  type: string;
  /** 施工日 */
  appliedDate: Date;
  /** 状態 */
  condition: "良好" | "劣化" | "剥がれ";
  /** 写真 */
  photo?: Photo;
}

/**
 * コーティング剤
 */
export interface CoatingMaterial {
  /** コーティング剤の種類 */
  type: string;
  /** 使用量 */
  quantity: number;
  /** メーカー・型番 */
  manufacturer?: string;
  /** 型番 */
  modelNumber?: string;
}
```

---

## 5. 実装方針

### 5-1. 事前見積の実装

**設計**:
- 予約時または受付前に、事前見積画面を表示
- 車両の寸法を確認し、コーティングの種類を選択
- オプションサービスを選択（同時施工で10％割引を自動適用）
- 見積金額を自動計算
- 顧客に送信

### 5-2. オプションサービスの実装

**設計**:
- オプションサービスをマスタデータとして管理
- 同時施工の場合、自動で10％割引を適用
- オプションごとに個別に承認・却下を選択可能

### 5-3. 車両の寸法による金額計算

**設計**:
- 車両の寸法情報をGoogle Sheetsから取得
- マスタデータから該当する金額を取得（計算式は不要）
- 見積画面で金額を自動表示

### 5-4. 乾燥時間の管理

**設計**:
- 作業完了後、「乾燥中」ステータスに更新
- 乾燥完了後、「出庫待ち」ステータスに更新
- ステータス管理で乾燥期間を管理

---

## 6. 確認済み事項（追加）

### 6-1. 車両の寸法による金額計算

**質問**: 車両の寸法に応じた金額計算の具体的なロジックは？

**回答**: ✅ **マスタデータから取得**

**設計決定**:
- 車両の寸法情報をGoogle Sheetsから取得
- マスタデータから該当する金額を取得（計算式は不要）
- 見積画面で金額を自動表示

### 6-2. オプションサービスの同時施工判定

**質問**: どのオプションを選択した場合に「同時施工」と判定するか？

**回答**: ✅ **同じワークオーダー（同じ入庫）で実施する場合**

**設計決定**:
- 同じワークオーダー（同じ入庫）で実施する場合に10％割引を適用
- 基本コーティングとオプションサービスを同じ入庫で実施する場合、すべてのオプションに10％割引を適用

---

## 7. 次のステップ

1. **事前見積画面の実装**: 車両の寸法確認、コーティング種類選択、オプション選択、金額計算
2. **オプションサービスの実装**: オプション選択、同時施工判定、10％割引適用
3. **車両の寸法による金額計算の実装**: 寸法情報の取得、金額計算ロジック
4. **乾燥時間の管理実装**: ステータス管理、乾燥期間の管理

---

## 更新履歴

- 2025-01-XX: 初版作成（確認済み仕様書）


































