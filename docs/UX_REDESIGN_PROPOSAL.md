# UI/UX再設計提案 - ゼロベースでの検討

## 整備工場の実際の業務フロー

### シナリオ1: 単体作業（オイル交換のみ）

**実際の業務フロー:**
1. トップページでジョブカードを確認
2. 「オイル交換」と表示されている
3. 担当スタッフが「診断を開始」ボタンをクリック
4. オイル交換の診断画面に遷移
5. 診断 → 見積 → 承認 → 作業 → 納車

**現在のUI:**
- ✅ ジョブカードに「オイル交換」と表示
- ✅ 「診断を開始」ボタンで診断画面に遷移
- ✅ 問題なし

---

### シナリオ2: 複合作業（車検 + オイル交換）

**実際の業務フロー:**
1. トップページでジョブカードを確認
2. 「車検」と「オイル交換」の2つの作業が表示されている
3. **スタッフA（オイル交換担当）**: 「オイル交換」の「診断を開始」ボタンをクリック
4. オイル交換の診断画面に遷移
5. オイル交換の診断 → 見積 → 承認 → 作業 → 完了
6. **スタッフB（車検担当）**: 「車検」の「診断を開始」ボタンをクリック
7. 車検の診断画面に遷移
8. 車検の診断 → 見積 → 承認 → 作業 → 完了
9. 両方の作業が完了したら納車

**現在のUIの問題:**
- ❌ ジョブカードをクリック → 選択画面に遷移 → 作業を選ぶ
- ❌ 選択画面という中間ステップが不要
- ❌ ジョブカードの段階で作業が見えない

**理想のUI:**
- ✅ ジョブカード内に「車検」と「オイル交換」の2つのカードが表示される
- ✅ 各カードに「診断を開始」ボタンがある
- ✅ クリックしたら、その作業の診断画面に直接遷移

---

## ゼロベースでのUI/UX設計

### 設計原則

1. **ジョブカードがすべての情報を表示する**
   - 単体作業: 1つの作業カード
   - 複合作業: 複数の作業カード（縦に並べる）

2. **各作業カードが独立したアクションを持つ**
   - 各作業カードに「診断を開始」ボタン
   - クリックしたら、その作業の診断画面に直接遷移

3. **中間画面を排除する**
   - 選択画面は不要
   - ジョブカードから直接診断画面に遷移

4. **担当者別の作業管理**
   - 各作業カードに担当者情報を表示（あれば）
   - 担当者が自分の作業をすぐに見つけられる

---

## 新しいUI設計

### ジョブカードの構造

```
┌─────────────────────────────────────────┐
│ ジョブカード（顧客情報、車両情報）      │
├─────────────────────────────────────────┤
│ 作業カード1: 車検                        │
│   - ステータス: 診断中                   │
│   - 担当: 山田整備士（あれば）          │
│   - [診断を開始] ボタン                 │
├─────────────────────────────────────────┤
│ 作業カード2: オイル交換                  │
│   - ステータス: 作業待ち                │
│   - 担当: 田中整備士（あれば）          │
│   - [診断を開始] ボタン                 │
└─────────────────────────────────────────┘
```

### 単体作業の場合

```
┌─────────────────────────────────────────┐
│ ジョブカード（顧客情報、車両情報）      │
├─────────────────────────────────────────┤
│ 作業: オイル交換                         │
│   - ステータス: 診断中                   │
│   - [診断を開始] ボタン                 │
└─────────────────────────────────────────┘
```

---

## 実装方針

### 1. ジョブカードの拡張

**現在:**
- ジョブカードに1つの「診断を開始」ボタン

**新しい設計:**
- ジョブカード内に作業カードを表示
- 各作業カードに「診断を開始」ボタン
- 単体作業の場合は、現在のUIを維持（後方互換性）

### 2. 作業カードコンポーネント

**新規作成:**
- `WorkOrderCard` コンポーネント
- 各作業の情報を表示
- 「診断を開始」ボタンで診断画面に遷移

### 3. 診断画面への遷移

**URL設計:**
- 単体作業: `/mechanic/diagnosis/{jobId}`
- 複合作業: `/mechanic/diagnosis/{jobId}?workOrder={workOrderId}`

**リダイレクト:**
- 複合作業で`workOrder`パラメータがない場合は、最初の作業を自動選択
- または、ジョブカードから直接遷移するため、常に`workOrder`パラメータが付与される

---

## ユーザージャーニー（再設計後）

### パターン1: 単体作業（オイル交換のみ）

```
トップページ
  ↓
ジョブカード（オイル交換）
  ↓
[診断を開始] ボタンをクリック
  ↓
オイル交換の診断画面
  ↓
診断 → 見積 → 承認 → 作業 → 納車
```

### パターン2: 複合作業（車検 + オイル交換）

```
トップページ
  ↓
ジョブカード
  ├─ 作業カード1: 車検
  │   └─ [診断を開始] ボタン
  └─ 作業カード2: オイル交換
      └─ [診断を開始] ボタン
  ↓
スタッフA: オイル交換の[診断を開始]をクリック
  ↓
オイル交換の診断画面（workOrder=wo-oil-change）
  ↓
オイル交換の診断 → 見積 → 承認 → 作業 → 完了
  ↓
スタッフB: 車検の[診断を開始]をクリック
  ↓
車検の診断画面（workOrder=wo-inspection）
  ↓
車検の診断 → 見積 → 承認 → 作業 → 完了
  ↓
両方完了 → 納車
```

---

## 実装の優先順位

### フェーズ1: ジョブカードの拡張（最優先）

1. `WorkOrderCard`コンポーネントを作成
2. ジョブカード内に作業カードを表示
3. 各作業カードに「診断を開始」ボタンを追加
4. 単体作業の場合は、現在のUIを維持

### フェーズ2: 選択画面の削除

1. 選択画面（`/select`）を削除
2. 診断画面での自動リダイレクトを削除
3. ジョブカードから直接診断画面に遷移

### フェーズ3: 作業画面への対応

1. 作業画面でも同様に作業カードを表示
2. 各作業カードに「作業を開始」ボタンを追加

---

## メリット

1. **直感的なUI**
   - ジョブカードの段階で作業が見える
   - 中間画面が不要

2. **担当者別の作業管理**
   - 各スタッフが自分の作業をすぐに見つけられる
   - 担当者情報を表示（あれば）

3. **シンプルなフロー**
   - ジョブカード → 診断画面（直接）
   - 選択画面という中間ステップが不要

4. **後方互換性**
   - 単体作業の場合は、現在のUIを維持

---

## まとめ

**現在の問題:**
- 選択画面という中間ステップが不要
- ジョブカードの段階で作業が見えない
- UX的に分かりにくい

**新しい設計:**
- ジョブカード内に作業カードを表示
- 各作業カードに「診断を開始」ボタン
- クリックしたら、その作業の診断画面に直接遷移
- 選択画面は不要

**実装方針:**
- ジョブカードを拡張して、作業カードを表示
- 選択画面を削除
- 診断画面への直接遷移を実現

