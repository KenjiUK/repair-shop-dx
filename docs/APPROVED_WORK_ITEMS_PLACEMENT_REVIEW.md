# 「承認済み作業内容」表示位置のレビュー

## 📋 現状の実装

### 現在の表示位置
- **場所**: 案件カードの上部セクション（ボタン行）
- **表示条件**: `job.field13 && (job.field5 === "見積提示済み" || job.field5 === "作業待ち" || job.field5 === "出庫待ち" || job.field5 === "出庫済み")`
- **表示タイミング**: 見積承認後から出庫済みまで

### 現在のレイアウト構造
```
上部セクション:
├─ 顧客情報
├─ 車両情報
├─ 入庫カテゴリバッジ
├─ 時間・タグ・代車情報
├─ 長期プロジェクト進捗（該当時）
└─ ボタン行
   ├─ お客様入力情報
   ├─ 承認済み作業内容 ← 現在ここ
   ├─ 受付メモ
   ├─ 作業メモ
   ├─ 変更申請あり
   └─ 受付メモを追加

下部セクション:
└─ 作業一覧（折りたたみ可能）
   └─ 各作業オーダーカード
```

---

## ❌ 問題点

### 1. 複合業務での不整合
- **問題**: 複合業務（例：車検 + 板金・塗装）の場合、各作業オーダーごとに承認済み作業内容が異なる可能性がある
- **影響**: 上部に表示すると、どの作業オーダーの承認済み作業内容なのか不明確
- **例**: 車検の承認済み作業内容と板金・塗装の承認済み作業内容が混在する可能性

### 2. 情報の階層構造の不整合
- **問題**: 上部セクションは「案件レベルの情報」、下部セクションは「作業レベルの情報」を表示する設計
- **影響**: 「承認済み作業内容」は作業レベルの情報なのに、案件レベルの情報として表示されている
- **設計原則**: 
  - 上部セクション: 顧客情報、車両情報、入庫情報など、案件全体に共通する情報
  - 下部セクション: 各作業オーダーごとの詳細情報

### 3. ワークフローの観点
- **問題**: 承認済み作業内容は作業画面で確認・実行するもの
- **影響**: 作業一覧セクションに表示する方が、作業開始時の確認が自然
- **ユーザージャーニー**: 
  - 現在: 上部で承認済み作業内容を確認 → 作業一覧を展開 → 作業を開始
  - 推奨: 作業一覧を展開 → 各作業オーダーで承認済み作業内容を確認 → 作業を開始

### 4. UI/UXの一貫性
- **問題**: 他の作業関連情報（作業メモ、作業進捗など）は作業一覧セクションに表示されている
- **影響**: 「承認済み作業内容」だけが上部に表示されているのは一貫性がない

---

## ✅ 改善提案

### 提案A: 作業一覧セクション内の各作業オーダーカードに表示（推奨）

**実装方法**:
- 各作業オーダーカード内に「承認済み作業内容」ボタンを表示
- 作業オーダーごとに承認済み作業内容を管理（`workOrder.estimate?.approvedItems`など）

**メリット**:
- ✅ 複合業務でも各作業オーダーごとに明確に表示
- ✅ 情報の階層構造が明確
- ✅ ワークフローに沿った表示
- ✅ UI/UXの一貫性が保たれる

**デメリット**:
- ⚠️ 作業一覧を展開しないと確認できない（ただし、これは意図的な設計）

### 提案B: 作業一覧セクションのヘッダーに表示

**実装方法**:
- 作業一覧セクションの展開ボタンの横に「承認済み作業内容」ボタンを表示
- 単一作業の場合のみ表示（複合業務の場合は各作業オーダーカード内に表示）

**メリット**:
- ✅ 展開しなくても確認可能
- ✅ 単一作業の場合は簡潔

**デメリット**:
- ⚠️ 複合業務の場合、どの作業オーダーの承認済み作業内容なのか不明確
- ⚠️ 情報の階層構造が曖昧

---

## 🎯 推奨実装

**提案Aを推奨**します。

### 実装方針
1. **上部セクションから「承認済み作業内容」ボタンを削除**
2. **作業一覧セクション内の各作業オーダーカードに「承認済み作業内容」ボタンを追加**
3. **作業オーダーごとに承認済み作業内容を管理**（将来的には`workOrder.estimate?.approvedItems`から取得）

### 表示条件
- 作業オーダーのステータスが「見積作成待ち」「顧客承認待ち」「作業待ち」「作業中」「完了」の場合
- 作業オーダーに承認済み作業内容が存在する場合

### レイアウト
```
作業一覧セクション（展開時）:
└─ 作業オーダーカード1
   ├─ 作業名
   ├─ ステータス
   ├─ 整備士情報
   ├─ 承認済み作業内容ボタン ← 追加
   └─ アクションボタン
```

---

## 📝 実装時の注意事項

1. **後方互換性**: 既存の`job.field13`から作業オーダーごとの承認済み作業内容を抽出する必要がある（将来的には`workOrder.estimate?.approvedItems`に移行）
2. **複合業務**: 各作業オーダーごとに承認済み作業内容を正しく表示する
3. **単一作業**: 単一作業の場合でも、作業一覧セクション内に表示する（一貫性のため）


