# テスト実行チェックリスト

**プロジェクト名**: 整備工場DXプラットフォーム  
**バージョン**: 1.0.0-beta.1  
**最終更新日**: 2025-01-XX

---

## 使用方法

このチェックリストは、テスト計画に基づいて実際のテストを実行する際に使用します。

- ✅: 完了
- ⬜: 未着手
- 🔄: 進行中
- ❌: 失敗
- ⚠️: 問題あり（要確認）

---

## 1. 単体テストチェックリスト

### 1-1. ユーティリティ関数 (`src/lib/`)

#### `utils.ts`
- [ ] `cn()`関数のテスト
- [ ] その他のヘルパー関数のテスト

#### `api.ts`
- [ ] API呼び出し関数のテスト
- [ ] エラーハンドリングのテスト
- [ ] リトライ機能のテスト

#### `zoho-api-client.ts`
- [ ] Zoho APIクライアントのテスト
- [ ] 認証機能のテスト
- [ ] リトライ機能のテスト

#### `google-sheets.ts`
- [ ] Google Sheets API呼び出しのテスト
- [ ] データ取得のテスト
- [ ] エラーハンドリングのテスト

#### `google-drive.ts`
- [ ] Google Drive API呼び出しのテスト
- [ ] ファイルアップロードのテスト
- [ ] フォルダ作成のテスト
- [ ] エラーハンドリングのテスト

#### `compress.ts`
- [ ] 画像圧縮機能のテスト
- [ ] 圧縮率のテスト
- [ ] エラーハンドリングのテスト

#### `search-utils.ts`
- [ ] 検索機能のテスト
- [ ] フィルタリング機能のテスト

#### `filter-utils.ts`
- [ ] フィルタリング機能のテスト

#### `photo-position.ts`
- [x] 写真位置計算のテスト（既存）

#### `error-handling.ts`
- [ ] エラーハンドリングのテスト

#### `customer-update.ts`
- [ ] 顧客情報更新ロジックのテスト
- [ ] データ整合性のテスト

#### `new-vehicle-creation.ts`
- [ ] 新規車両作成ロジックのテスト
- [ ] データ整合性のテスト

#### `work-order-converter.ts`
- [ ] 作業指示書変換のテスト

#### `inspection-checklist-parser.ts`
- [ ] 点検チェックリスト解析のテスト

#### `long-term-project-utils.ts`
- [ ] 長期プロジェクト判定のテスト

#### `rbac.ts`
- [ ] ロールベースアクセス制御のテスト

### 1-2. カスタムフック (`src/hooks/`)

#### `use-auth.ts`
- [ ] 認証状態管理のテスト
- [ ] ログイン/ログアウトのテスト

#### `use-auto-save.ts`
- [ ] 自動保存機能のテスト
- [ ] デバウンス機能のテスト

#### `use-auto-sync.ts`
- [ ] 自動同期機能のテスト
- [ ] オフライン/オンライン状態のテスト

#### `use-debounce.ts`
- [ ] デバウンス機能のテスト

#### `use-master-data.ts`
- [ ] マスタデータ取得のテスト
- [ ] キャッシュ機能のテスト

#### `use-online-status.ts`
- [ ] オンライン状態検知のテスト

#### `use-optimistic-update.ts`
- [ ] 楽観的更新のテスト

#### `use-smart-tags.ts`
- [ ] スマートタグ管理のテスト

#### `use-work-orders.ts`
- [ ] 作業指示書管理のテスト

### 1-3. UIコンポーネント (`src/components/ui/`)

#### `button.tsx`
- [ ] クリック機能のテスト
- [ ] 無効状態のテスト
- [ ] ローディング状態のテスト

#### `input.tsx`
- [ ] 入力機能のテスト
- [ ] バリデーションのテスト
- [ ] エラー表示のテスト

#### `textarea.tsx`
- [ ] 入力機能のテスト
- [ ] バリデーションのテスト

#### `select.tsx`
- [ ] 選択機能のテスト
- [ ] オプション表示のテスト

#### `dialog.tsx`
- [ ] 開閉機能のテスト
- [ ] フォーカス管理のテスト

### 1-4. 機能コンポーネント (`src/components/features/`)

#### `job-card.tsx`
- [ ] 表示機能のテスト
- [ ] クリック機能のテスト
- [ ] 状態変更のテスト

#### `job-search-bar.tsx`
- [ ] 検索機能のテスト
- [ ] フィルタリング機能のテスト

#### `customer-detail-dialog.tsx`
- [ ] 表示機能のテスト
- [ ] 編集機能のテスト
- [ ] 保存機能のテスト

#### `vehicle-detail-dialog.tsx`
- [ ] 表示機能のテスト
- [ ] 編集機能のテスト
- [ ] 保存機能のテスト

#### `work-order-dialog.tsx`
- [ ] 表示機能のテスト
- [ ] 編集機能のテスト
- [ ] 保存機能のテスト

#### `photo-capture-button.tsx`
- [ ] 写真撮影機能のテスト
- [ ] アップロード機能のテスト

#### `audio-input-button.tsx`
- [ ] 音声入力機能のテスト
- [ ] 音声認識機能のテスト

#### `traffic-light-button.tsx`
- [ ] 状態表示のテスト
- [ ] クリック機能のテスト

---

## 2. 結合テストチェックリスト

### 2-1. APIエンドポイント (`src/app/api/`)

#### `/api/zoho/*`
- [ ] Zoho CRM連携のテスト
- [ ] 認証機能のテスト
- [ ] エラーハンドリングのテスト

#### `/api/google-sheets/*`
- [ ] Google Sheets連携のテスト
- [ ] データ取得のテスト

#### `/api/google-drive/*`
- [ ] Google Drive連携のテスト
- [ ] ファイルアップロードのテスト

#### `/api/jobs/*`
- [ ] ジョブ取得のテスト
- [ ] ジョブ更新のテスト

#### `/api/smart-tags/*`
- [ ] スマートタグ管理のテスト

#### `/api/auth/*`
- [ ] 認証機能のテスト
- [ ] セッション管理のテスト

#### `/api/line/*`
- [ ] LINE連携のテスト

#### `/api/realtime/*`
- [ ] リアルタイム同期のテスト

### 2-2. 画面とAPIの連携

#### `/` (TOP)
- [ ] ジョブ一覧取得のテスト
- [ ] チェックイン処理のテスト
- [ ] タグ紐付けのテスト

#### `/mechanic/diagnosis/[id]`
- [ ] 診断データ保存のテスト
- [ ] 写真アップロードのテスト

#### `/admin/estimate/[id]`
- [ ] 見積作成のテスト
- [ ] 見積保存のテスト

#### `/customer/approval/[id]`
- [ ] 見積承認のテスト
- [ ] 見積却下のテスト

#### `/mechanic/work/[id]`
- [ ] 作業記録のテスト
- [ ] 写真アップロードのテスト

#### `/customer/report/[id]`
- [ ] レポート表示のテスト

### 2-3. 外部システム連携

#### Zoho CRM
- [ ] データ取得のテスト
- [ ] データ更新のテスト
- [ ] エラーハンドリングのテスト

#### Google Sheets
- [ ] マスタデータ取得のテスト
- [ ] キャッシュ機能のテスト

#### Google Drive
- [ ] ファイルアップロードのテスト
- [ ] フォルダ作成のテスト

#### LINE
- [ ] メッセージ送信のテスト
- [ ] Webhook受信のテスト

---

## 3. ユーザーシナリオテストチェックリスト

### 3-1. シナリオパターン1: 新規顧客の定期点検（標準フロー）

**前提条件:**
- [ ] 新規顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**Phase 0（事前チェックイン）**
- [ ] 顧客が事前チェックインURLにアクセス
- [ ] 顧客情報入力
- [ ] 車両情報入力
- [ ] 不具合・問診内容入力
- [ ] 送信

**Phase 1（受付）**
- [ ] 受付スタッフがTOPページで新規顧客を確認
- [ ] 事前入力情報（📝アイコン）を確認
- [ ] チェックイン処理
- [ ] スマートタグ紐付け
- [ ] ステータス「入庫済み」に変更

**Phase 2（診断）**
- [ ] メカニックが診断画面を開く
- [ ] 事前入力情報を確認
- [ ] 診断項目入力
- [ ] 写真撮影（9ポジション）
- [ ] 診断結果保存
- [ ] ステータス「見積作成待ち」に変更

**Phase 3（見積作成）**
- [ ] 事務員が見積画面を開く
- [ ] 診断結果を確認
- [ ] 見積項目入力
- [ ] 見積金額計算
- [ ] 見積保存
- [ ] ステータス「作業待ち」に変更

**Phase 4（顧客承認）**
- [ ] 顧客が承認画面にアクセス
- [ ] 見積内容を確認
- [ ] 承認ボタンをクリック

**Phase 5（作業）**
- [ ] メカニックが作業画面を開く
- [ ] 承認済み見積を確認
- [ ] 作業実施
- [ ] After写真撮影
- [ ] 作業完了報告
- [ ] ステータス「出庫待ち」に変更

**Phase 6（報告）**
- [ ] 顧客がレポート画面にアクセス
- [ ] 作業完了報告を確認
- [ ] 写真・動画を確認

**確認項目:**
- [ ] すべてのPhaseでデータが正しく保存されている
- [ ] ステータス遷移が正しい
- [ ] 写真が正しくアップロードされている
- [ ] 見積金額が正しく計算されている
- [ ] 顧客への通知が正しく送信されている

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-2. シナリオパターン2: 既存顧客の故障修理（緊急対応）

**前提条件:**
- [ ] 既存顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**Phase 1（受付）**
- [ ] 受付スタッフがTOPページで顧客検索
- [ ] 既存顧客情報を確認
- [ ] チェックイン処理
- [ ] 緊急対応フラグを設定
- [ ] ステータス「入庫済み」に変更

**Phase 2（診断）**
- [ ] メカニックが診断画面を開く
- [ ] 緊急対応フラグを確認
- [ ] 診断項目入力
- [ ] OBD診断結果入力
- [ ] 写真撮影
- [ ] 診断結果保存

**Phase 3（見積作成）**
- [ ] 事務員が見積画面を開く
- [ ] 緊急対応を考慮した見積作成
- [ ] 見積保存

**Phase 4（顧客承認）**
- [ ] 顧客が承認画面にアクセス
- [ ] 緊急対応の見積を確認
- [ ] 承認

**Phase 5（作業）**
- [ ] メカニックが作業画面を開く
- [ ] 緊急対応の作業実施
- [ ] 作業完了報告

**確認項目:**
- [ ] 緊急対応フラグが正しく機能している
- [ ] 既存顧客情報が正しく表示されている
- [ ] OBD診断結果が正しく保存されている

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-3. シナリオパターン3: VIP顧客の板金・塗装（長期プロジェクト）

**前提条件:**
- [ ] VIP顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**Phase 0（事前チェックイン）**
- [ ] 顧客が事前チェックイン
- [ ] 板金・塗装の詳細を入力

**Phase 1（受付）**
- [ ] 受付スタッフがTOPページでVIP顧客を確認
- [ ] 重要な顧客フラグ（⭐）を確認
- [ ] チェックイン処理
- [ ] 長期プロジェクトとして分類

**Phase 2（診断）**
- [ ] メカニックが診断画面を開く
- [ ] 板金・塗装の診断項目入力
- [ ] 写真撮影（詳細）
- [ ] 診断結果保存

**Phase 3（見積作成）**
- [ ] 事務員が見積画面を開く
- [ ] 板金・塗装の見積作成
- [ ] 長期プロジェクトの見積保存

**Phase 4（顧客承認）**
- [ ] 顧客が承認画面にアクセス
- [ ] 長期プロジェクトの見積を確認
- [ ] 承認

**Phase 5（作業）**
- [ ] メカニックが作業画面を開く
- [ ] 長期プロジェクトの作業実施
- [ ] 進捗管理
- [ ] 作業完了報告

**確認項目:**
- [ ] VIP顧客フラグが正しく機能している
- [ ] 長期プロジェクトとして正しく分類されている
- [ ] 進捗管理が正しく機能している

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-4. シナリオパターン4: レストアプロジェクト（超長期）

**前提条件:**
- [ ] 既存顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**Phase 1（受付）**
- [ ] 受付スタッフがチェックイン
- [ ] レストアプロジェクトとして分類

**Phase 2（診断）**
- [ ] メカニックが診断画面を開く
- [ ] レストアの診断項目入力
- [ ] 必要な部品リスト作成
- [ ] 診断結果保存

**Phase 3（見積作成）**
- [ ] 事務員が見積画面を開く
- [ ] レストアの見積作成
- [ ] 部品調達待ちフラグを設定
- [ ] 見積保存

**Phase 4（顧客承認）**
- [ ] 顧客が承認画面にアクセス
- [ ] レストアの見積を確認
- [ ] 承認

**Phase 5（作業）**
- [ ] メカニックが作業画面を開く
- [ ] 部品調達待ち状態を確認
- [ ] 部品到着後、作業実施
- [ ] 作業完了報告

**確認項目:**
- [ ] レストアプロジェクトとして正しく分類されている
- [ ] 部品調達待ちフラグが正しく機能している
- [ ] 長期プロジェクトの進捗管理が正しく機能している

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-5. シナリオパターン5: チューニング（特殊作業）

**前提条件:**
- [ ] 既存顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**Phase 0（事前チェックイン）**
- [ ] 顧客が事前チェックイン
- [ ] チューニングの詳細を入力

**Phase 1（受付）**
- [ ] 受付スタッフがチェックイン
- [ ] チューニングとして分類

**Phase 2（診断）**
- [ ] メカニックが診断画面を開く
- [ ] チューニングの診断項目入力
- [ ] チューニングパーツタイプ選択
- [ ] 診断結果保存

**Phase 3（見積作成）**
- [ ] 事務員が見積画面を開く
- [ ] チューニングの見積作成
- [ ] 見積保存

**Phase 4（顧客承認）**
- [ ] 顧客が承認画面にアクセス
- [ ] チューニングの見積を確認
- [ ] 承認

**Phase 5（作業）**
- [ ] メカニックが作業画面を開く
- [ ] チューニング作業実施
- [ ] 作業完了報告

**確認項目:**
- [ ] チューニングとして正しく分類されている
- [ ] チューニングパーツタイプが正しく選択されている
- [ ] 特殊作業の見積が正しく作成されている

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-6. シナリオパターン6: 見積却下（顧客が承認しない）

**前提条件:**
- [ ] 既存顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**Phase 1（受付）**
- [ ] 受付スタッフがチェックイン

**Phase 2（診断）**
- [ ] メカニックが診断
- [ ] 診断結果保存

**Phase 3（見積作成）**
- [ ] 事務員が見積作成
- [ ] 見積保存

**Phase 4（顧客承認 - 却下）**
- [ ] 顧客が承認画面にアクセス
- [ ] 見積内容を確認
- [ ] **却下ボタンをクリック**
- [ ] 却下理由を入力

**Phase 3（見積再作成）**
- [ ] 事務員が却下理由を確認
- [ ] 見積を修正
- [ ] 見積再保存

**Phase 4（顧客承認 - 再承認）**
- [ ] 顧客が承認画面にアクセス
- [ ] 修正された見積を確認
- [ ] 承認

**確認項目:**
- [ ] 見積却下が正しく処理されている
- [ ] 却下理由が正しく保存されている
- [ ] 見積再作成が正しく機能している

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-7. シナリオパターン7: オフライン対応（ネットワーク切断）

**前提条件:**
- [ ] 既存顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**オフライン状態で操作**
- [ ] ネットワークを切断
- [ ] 診断画面を開く
- [ ] 診断データ入力
- [ ] 保存ボタンをクリック
- [ ] オフラインバナーが表示されることを確認
- [ ] データがローカルに保存されることを確認

**オンライン復帰**
- [ ] ネットワークを復帰
- [ ] 自動同期が実行されることを確認
- [ ] データが正しくサーバーに保存されることを確認

**確認項目:**
- [ ] オフライン状態が正しく検知されている
- [ ] オフラインバナーが正しく表示されている
- [ ] データがローカルに正しく保存されている
- [ ] オンライン復帰時に自動同期が正しく機能している

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-8. シナリオパターン8: 複数ユーザー同時操作（競合制御）

**前提条件:**
- [ ] 既存顧客データを作成
- [ ] 車両データを作成
- [ ] ジョブデータを作成

**同時編集**
- [ ] ユーザーAが診断画面を開く
- [ ] ユーザーBが同じ診断画面を開く
- [ ] ユーザーAが診断データを保存
- [ ] ユーザーBが診断データを保存
- [ ] 競合が正しく検知されることを確認

**リアルタイム同期**
- [ ] ユーザーAがデータを更新
- [ ] ユーザーBの画面が自動更新されることを確認

**確認項目:**
- [ ] 競合制御が正しく機能している
- [ ] リアルタイム同期が正しく機能している
- [ ] データの整合性が保たれている

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-9. シナリオパターン9: エラー処理（API障害）

**前提条件:**
- [ ] テスト環境を準備

**Zoho CRM API障害**
- [ ] Zoho CRM APIを無効化
- [ ] データ保存を試行
- [ ] エラーメッセージが正しく表示されることを確認
- [ ] リトライ機能が正しく動作することを確認

**Google Drive API障害**
- [ ] Google Drive APIを無効化
- [ ] ファイルアップロードを試行
- [ ] エラーメッセージが正しく表示されることを確認
- [ ] リトライ機能が正しく動作することを確認

**確認項目:**
- [ ] エラーメッセージが正しく表示されている
- [ ] リトライ機能が正しく動作している
- [ ] ユーザーに適切なフィードバックが提供されている

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

### 3-10. シナリオパターン10: パフォーマンステスト（大量データ）

**前提条件:**
- [ ] 大量のジョブデータを作成（100件以上）
- [ ] 大量の写真データを準備（50枚以上）

**大量データ表示**
- [ ] TOPページで100件以上のジョブを表示
- [ ] ページ読み込み時間を測定
- [ ] スクロール性能を確認

**大量写真アップロード**
- [ ] 50枚以上の写真をアップロード
- [ ] アップロード時間を測定
- [ ] メモリ使用量を確認

**確認項目:**
- [ ] ページ読み込み時間が3秒以内
- [ ] スクロールがスムーズに動作している
- [ ] メモリリークが発生していない
- [ ] アップロードが正常に完了している

**発見されたバグ:**
- [ ] バグ1: [説明]
- [ ] バグ2: [説明]

---

## 4. デザインシステム準拠チェックリスト

### 4-1. フォントサイズ

- [ ] すべてのテキストで`text-base` (16px) 以上を使用しているか
- [ ] `text-xs` (12px) を使用していないか
- [ ] `text-sm` (14px) は最小限の使用か
- [ ] すべてのバッジで`text-base` (16px) を使用しているか

### 4-2. ボタンサイズ

- [ ] すべてのボタンで`h-12` (48px) を使用しているか
- [ ] タッチターゲットが最小48px × 48pxを確保しているか
- [ ] DialogFooter内のボタンが`h-12` (48px) か

### 4-3. アイコンサイズ

- [ ] すべてのアイコンで`h-4 w-4` (16px) 以上を使用しているか
- [ ] `h-3 w-3` (12px) や `size-3` (12px) を使用していないか
- [ ] ボタン内アイコンが`h-5 w-5` (20px) か

### 4-4. カラーとコントラスト

- [ ] テキストと背景のコントラスト比が4.5:1以上か
- [ ] ステータスバッジの色が統一されているか
- [ ] 入庫区分バッジの色が統一されているか
- [ ] エラーメッセージの色が`text-red-600`か

### 4-5. スペーシングとレイアウト

- [ ] モバイル対応のgapを使用しているか（`gap-1.5 sm:gap-2`など）
- [ ] バッジに`whitespace-nowrap`と`shrink-0`を設定しているか
- [ ] セクション間は`mb-6`を使用しているか

### 4-6. アクセシビリティ

- [ ] すべてのインタラクティブ要素に適切な`aria-label`が設定されているか
- [ ] すべてのフォーム要素に適切な`aria-required`, `aria-invalid`が設定されているか
- [ ] すべてのエラーメッセージに`role="alert"`が設定されているか
- [ ] すべての機能をキーボードで操作可能か

### 4-7. アニメーションとインタラクション

- [ ] ボタン、リンク、バッジに適切なホバー効果があるか
- [ ] 入力フィールド、ボタンに適切なフォーカスリングがあるか
- [ ] アニメーションの速度が適切か（200ms, 300ms, 500ms以下）

### 4-8. スマートフォン対応

- [ ] タッチターゲットが最小48px × 48pxを確保しているか
- [ ] 要素間は最低8px（`gap-2`）を確保しているか
- [ ] モバイル/PCで適切に表示されるか

---

## 5. バグ管理

### 4-1. 発見されたバグ一覧

| バグID | 発見日 | 発見者 | 優先度 | カテゴリ | 概要 | ステータス |
|--------|--------|--------|--------|----------|------|-----------|
| BUG-001 | | | P1 | | | ⬜ |
| BUG-002 | | | P2 | | | ⬜ |

### 4-2. バグ修正状況

- **総バグ数**: 0件
- **修正済み**: 0件
- **残り**: 0件

---

## 6. テスト進捗サマリー

### 5-1. 単体テスト

- **総テストケース数**: 50
- **完了**: 0
- **進行中**: 0
- **未着手**: 50
- **進捗率**: 0%

### 5-2. 結合テスト

- **総テストケース数**: 30
- **完了**: 0
- **進行中**: 0
- **未着手**: 30
- **進捗率**: 0%

### 5-3. ユーザーシナリオテスト

- **総シナリオ数**: 10
- **完了**: 0
- **進行中**: 0
- **未着手**: 10
- **進捗率**: 0%

---

**最終更新**: 2025-01-XX

