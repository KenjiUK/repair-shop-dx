# 本日入出庫予定カード 追加提案

## 📋 概要

サマリーカードセクションに「本日入出庫予定」カードを追加する提案です。

## 🎯 目的

### 業務上の重要性

1. **入庫予定の把握**
   - 本日の入庫予定を事前に確認できる
   - 受付準備ができる
   - スタッフの配置計画が立てられる

2. **出庫予定の把握**
   - 本日の出庫予定を確認できる
   - 作業完了の目安が分かる
   - 顧客への連絡タイミングが分かる

3. **業務フローの最適化**
   - 予定と実績の比較ができる
   - 遅延や変更を早期に発見できる
   - 業務の見える化が進む

## 📊 表示内容の提案

### 基本情報

1. **入庫予定**
   - 件数（バッジ表示）
   - 予定時刻順にリスト表示
   - 顧客名・車両情報
   - 予約時間（field22または予約データから）

2. **出庫予定**
   - 件数（バッジ表示）
   - 予定時刻順にリスト表示
   - 顧客名・車両情報
   - 出庫予定時刻

3. **ステータス表示**
   - 入庫済み/未入庫
   - 出庫済み/未出庫
   - 遅延警告（予定時刻を過ぎている場合）

### UIデザイン

```
┌─────────────────────────────┐
│ 📅 本日入出庫予定        [5] │
├─────────────────────────────┤
│ 入庫予定 (3件)              │
│ ┌─────────────────────────┐ │
│ │ 🕐 10:00 山田様         │ │
│ │    トヨタ プリウス      │ │
│ └─────────────────────────┘ │
│ ┌─────────────────────────┐ │
│ │ 🕐 14:00 佐藤様         │ │
│ │    ホンダ フィット      │ │
│ └─────────────────────────┘ │
│                             │
│ 出庫予定 (2件)              │
│ ┌─────────────────────────┐ │
│ │ ✅ 15:00 鈴木様         │ │
│ │    日産 リーフ          │ │
│ └─────────────────────────┘ │
└─────────────────────────────┘
```

## 🔍 データソースの検討

### オプション1: Zoho CRMの予約データ（推奨）⭐

**データソース:**
- `Appointments__s`（Zoho Bookingsデータ）
- `field22`（入庫予定日時）
- 出庫予定日時（カスタムフィールドまたは計算）

**メリット:**
- ✅ 予約システムと連携
- ✅ 正確な予定時刻が取得できる
- ✅ 予約変更が反映される

**デメリット:**
- ⚠️ 予約データの取得が必要
- ⚠️ 出庫予定時刻のフィールドが不明確

### オプション2: ジョブデータから推定

**データソース:**
- `field22`（入庫予定日時）
- ステータスから出庫予定を推定
- 作業時間から出庫予定を計算

**メリット:**
- ✅ 既存のデータを使用
- ✅ 実装が簡単

**デメリット:**
- ⚠️ 予定時刻が不正確な可能性
- ⚠️ 出庫予定の計算が複雑

### オプション3: ハイブリッド（推奨）⭐

**データソース:**
- 入庫予定: `Appointments__s`または`field22`
- 出庫予定: ジョブデータから推定（作業時間ベース）

**メリット:**
- ✅ 入庫予定は予約データから正確に取得
- ✅ 出庫予定は作業時間から推定
- ✅ 実装の柔軟性が高い

## 💡 実装提案

### コンポーネント構造

```tsx
<TodayScheduleCard
  jobs={jobs}
  appointments={appointments} // オプション
/>
```

### データ処理ロジック

1. **入庫予定の抽出**
   ```typescript
   const todayArrivals = jobs.filter((job) => {
     const arrivalDate = job.field22 ? new Date(job.field22) : null;
     if (!arrivalDate) return false;
     const today = new Date();
     return (
       arrivalDate.getFullYear() === today.getFullYear() &&
       arrivalDate.getMonth() === today.getMonth() &&
       arrivalDate.getDate() === today.getDate() &&
       job.field5 !== "入庫済み" // 未入庫のみ
     );
   });
   ```

2. **出庫予定の抽出**
   ```typescript
   const todayDepartures = jobs.filter((job) => {
     // 作業完了見込み時刻を計算
     const estimatedDeparture = calculateEstimatedDeparture(job);
     if (!estimatedDeparture) return false;
     const today = new Date();
     return (
       estimatedDeparture.getFullYear() === today.getFullYear() &&
       estimatedDeparture.getMonth() === today.getMonth() &&
       estimatedDeparture.getDate() === today.getDate() &&
       job.field5 !== "出庫済み" // 未出庫のみ
     );
   });
   ```

### UIコンポーネント

1. **カードタイトル**
   - アイコン: 📅 (Calendar)
   - タイトル: "本日入出庫予定"
   - バッジ: 合計件数

2. **入庫予定セクション**
   - 件数表示
   - 予定時刻順にリスト表示
   - クリックで該当ジョブにスクロール

3. **出庫予定セクション**
   - 件数表示
   - 予定時刻順にリスト表示
   - クリックで該当ジョブにスクロール

4. **ステータス表示**
   - 入庫済み/未入庫のバッジ
   - 遅延警告（予定時刻を過ぎている場合）

## 📍 配置場所の提案

### オプション1: 優先度1（最重要）として配置 ⭐

**配置:**
- 本日の状況、入庫区分別と同じ行に配置
- 3列のグリッドレイアウト

**メリット:**
- ✅ 最重要情報として表示
- ✅ 一目で確認できる

**デメリット:**
- ⚠️ 画面幅が狭くなる可能性

### オプション2: SummaryCarousel内に配置（推奨）⭐

**配置:**
- 整備士別、代車在庫、長期プロジェクト、業務分析と同じカルーセル内
- 最初または2番目に配置

**メリット:**
- ✅ 既存のレイアウトを維持
- ✅ 横スクロールで確認できる
- ✅ 実装が簡単

**デメリット:**
- ⚠️ カルーセル内のため、最初に見えない可能性

### オプション3: 独立したセクションとして配置

**配置:**
- サマリーカードセクションの下に独立したセクション

**メリット:**
- ✅ 目立つ位置に配置
- ✅ 詳細情報を表示できる

**デメリット:**
- ⚠️ 画面スペースを多く使用

## 🎨 UI/UXの考慮事項

### 1. 時刻表示

- **形式**: "10:00"（24時間表記）
- **遅延表示**: 予定時刻を過ぎている場合は赤色で表示
- **時刻順**: 早い順にソート

### 2. 顧客・車両情報

- **表示**: 顧客名 + 車種
- **省略**: 長い場合は省略表示（`truncate`）
- **クリック**: 該当ジョブにスクロール

### 3. ステータス表示

- **入庫済み**: ✅ グリーン
- **未入庫**: ⏰ グレー
- **遅延**: ⚠️ レッド

### 4. 空データ表示

- **メッセージ**: "本日の入出庫予定はありません"
- **デザイン**: 他のカードと統一

## 📊 比較表

| 項目 | オプション1（優先度1） | オプション2（カルーセル） | オプション3（独立セクション） |
|------|---------------------|----------------------|------------------------|
| **可視性** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| **実装の簡単さ** | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| **画面スペース** | ⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐ |
| **操作性** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **40歳以上ユーザー向け** | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐⭐ |

## ✅ 推奨案

### 最推奨: オプション2（SummaryCarousel内に配置）⭐

**理由:**
1. **既存のレイアウトを維持**: 他のサマリーカードと同じ形式
2. **実装が簡単**: 既存のコンポーネントを活用
3. **横スクロールで確認**: 必要に応じて確認できる
4. **優先順位が適切**: 重要だが、本日の状況ほど頻繁に見ない

**実装内容:**
- `SummaryCarousel`内の最初または2番目に配置
- `TodayScheduleCard`コンポーネントを作成
- 入庫予定・出庫予定を表示
- クリックで該当ジョブにスクロール

---

### 代替案: オプション1（優先度1として配置）

**理由:**
- 最重要情報として表示
- 一目で確認できる
- ただし、画面幅が狭くなる可能性

---

## 📝 実装時の注意事項

1. **データ取得**
   - 予約データ（`Appointments__s`）の取得が必要
   - 出庫予定時刻の計算ロジックを実装

2. **パフォーマンス**
   - 本日のデータのみをフィルタリング
   - 時刻順にソート

3. **アクセシビリティ**
   - キーボード操作対応
   - スクリーンリーダー対応

4. **40歳以上ユーザー向け**
   - フォントサイズ: `text-base`（16px）以上
   - タッチターゲットサイズ: 48px以上
   - コントラスト比: 4.5:1以上

---

## 🎯 結論

**推奨: オプション2（SummaryCarousel内に配置）**

1. `SummaryCarousel`内の最初または2番目に配置
2. `TodayScheduleCard`コンポーネントを作成
3. 入庫予定・出庫予定を表示
4. クリックで該当ジョブにスクロール

**理由:**
- 既存のレイアウトを維持
- 実装が簡単
- 横スクロールで確認できる
- 優先順位が適切






