# 本番環境前 最終チェックリスト

**作成日:** 2025-01-XX  
**目的:** 本番環境デプロイ前の最終チェック。未実装機能、部分的実装、ロードマップから抜けている機能を洗い出し

---

## 📋 チェック概要

### 実装状況の分類

1. **✅ 完全実装済み**: 機能が完全に実装され、動作確認済み
2. **⚠️ 部分的実装**: 一部実装されているが、完全ではない
3. **❌ 未実装**: ロードマップやテスト結果に記載があるが、実装されていない
4. **🔍 要確認**: 実装状況が不明確、コードベースで確認が必要
5. **🚫 不要（実装しない）**: 業務要件により実装不要と判断された機能

---

## 1. ロードマップ Phase 0-5 の実装状況

### Phase 0: 基盤システム連携 ✅ 完了

- ✅ Zoho CRM連携（モック環境）
- ✅ Google Sheets連携（マスタデータ同期）
- ✅ Google Drive連携（ファイル保存）
- ✅ GAS実装
- ✅ スマートタグ管理システム

### Phase 1: 共通基盤と複数作業管理 ✅ 完了

- ✅ 共通UI/UXコンポーネントライブラリ
- ✅ 統一データモデル（複数作業管理対応）
- ✅ API設計の統一実装
- ✅ 複数作業管理機能
- ✅ エラーハンドリング
- ✅ オフライン対応基盤
- ✅ セキュリティ基盤
- ✅ 効果測定基盤
- ✅ Zoho API制約対応
- ✅ 顧客(Contacts)モジュール更新制約対応

### Phase 2: 主要入庫区分 ✅ 完了

- ✅ 車検、12ヵ月点検、エンジンオイル交換、故障診断、修理・整備
- ✅ 顧客向け進捗通知機能（LINE）
- ✅ ブログ用写真の管理機能

### Phase 3: 複数作業管理の統合 ✅ 完了

- ✅ 複数作業管理機能の統合
- ✅ 見積作成フローの基幹システム連携
- ✅ 請求書統合フロー
- ✅ マスタデータ同期

### Phase 4: 拡張入庫区分 ✅ 完了

- ✅ コーティング、タイヤ交換・ローテーション、その他のメンテナンス
- ✅ チューニング・パーツ取付、板金・塗装、レストア、その他

### Phase 5: 高度な機能 ⚠️ 未実装（低優先度）

- ❌ 長期カスタムの管理機能の強化
- ❌ ビデオコミュニケーション機能
- ❌ 顧客ポータル機能（一部実装済み：見積確認・承認）
- ❌ リアルタイム同期機能の強化（オフライン対応は実装済み）

---

## 2. UXテスト結果から抽出された改善提案の実装状況

### 優先度: 高（最優先）

#### ✅ 改善提案 #11: 承認待ち案件のフォローアップ機能の強化
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/lib/pending-approval-utils.ts` - 承認待ち期間計算、長期化判定
  - `src/components/features/job-card.tsx` - 警告アイコン表示、承認待ち日数表示
  - `src/app/page.tsx` - 長期化承認待ちフィルター
- **確認**: コードベースで確認済み

#### ✅ 改善提案 #3: 部品調達待ち案件の管理機能
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/lib/parts-info-utils.ts` - 部品調達日数計算、長期化判定、期限切れ判定
  - `src/components/features/parts-list-input.tsx` - 部品管理UI
  - `src/components/features/parts-info-dialog.tsx` - 部品情報ダイアログ
  - `src/app/page.tsx` - 長期化部品調達フィルター
  - `src/app/admin/estimate/[id]/page.tsx` - 全部品到着時の自動通知
- **確認**: コードベースで確認済み

#### ✅ 改善提案 #1: フィルター機能の強化
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/lib/filter-utils.ts` - 緊急案件判定、重要顧客判定、フィルター適用ロジック
  - `src/lib/important-customer-flag.ts` - 重要顧客フラグ管理
  - `src/app/page.tsx` - 緊急案件・重要顧客フィルターボタンUI
  - 複数フィルターの同時適用対応
- **確認**: コードベースで確認済み

#### ✅ 改善提案 #2: 検索機能の実装
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/lib/search-utils.ts` - 検索ロジック、オートコンプリート候補生成
  - `src/components/features/job-search-bar.tsx` - 検索バーUI（折りたたみ式、QRコードスキャン統合、オートコンプリート）
  - `src/lib/search-history.ts` - 検索履歴管理
  - `src/app/page.tsx` - 検索機能の統合
- **確認**: コードベースで確認済み

#### ✅ 改善提案 #4: 輸入車整備工場特有の診断・作業記録機能の強化
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/components/features/enhanced-obd-diagnostic-section.tsx` - 拡張OBD診断結果セクション
  - `src/components/features/manufacturer-inquiry-section.tsx` - メーカー問い合わせセクション
  - `src/app/mechanic/diagnosis/[id]/page.tsx` - 診断画面への統合
  - レストア作業の進捗率記録（`RestoreWorkView`）
  - 品質管理チェックリスト（`BodyPaintOutsourcingView`）
- **確認**: コードベースで確認済み

#### ✅ 改善提案 #5: 詳細情報の表示機能の強化（店長向け）
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/components/features/mechanic-detail-dialog.tsx` - 整備士詳細情報ダイアログ
  - `src/components/features/mechanic-summary-card.tsx` - 整備士別サマリーカード
  - `src/lib/mechanic-skill-storage.ts` - スキルレベル管理
  - 作業量サマリー、ステータス別件数、作業負荷表示
  - スキルレベル表示（全体レベル、カテゴリー別レベル）
  - 担当案件リスト表示
  - 長期プロジェクトの進捗率表示（レストア、板金・塗装）
- **確認**: コードベースで確認済み

### 優先度: 中

#### ✅ 改善提案 #7: テンプレート機能の実装
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/lib/template-storage.ts` - 見積テンプレート管理
  - `src/components/features/estimate-template-dialog.tsx` - テンプレートUI
  - `src/app/admin/estimate/[id]/page.tsx` - テンプレート適用機能
- **確認**: コードベースで確認済み

#### ✅ 改善提案 #6: 過去の見積・案件の参照機能
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/lib/api.ts` - `fetchHistoricalEstimatesByCustomerId`, `fetchHistoricalJobsByCustomerId`
  - `src/components/features/historical-estimate-dialog.tsx` - 過去の見積参照ダイアログ
  - `src/components/features/historical-job-dialog.tsx` - 過去の案件参照ダイアログ
  - `src/app/admin/estimate/[id]/page.tsx` - ダイアログ統合、項目コピー機能
- **確認**: コードベースで確認済み

#### ✅ 改善提案 #8: 業務分析機能の実装
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/app/manager/analytics/page.tsx` - 業務分析ページ（週次・月次・四半期・年次）
  - `src/lib/api.ts` - `fetchAnalyticsData`関数
  - `src/lib/analytics-utils.ts` - 業務分析データ生成ロジック
  - 業務量トレンドグラフ、入庫区分別業務量、繁忙期・閑散期比較
- **確認**: コードベースで確認済み

#### 🚫 改善提案 #9: 予約変更・キャンセル機能の実装
- **実装状況**: 🚫 **不要（実装しない）**
- **理由**: 業務要件により不要と判断

#### ❌ 改善提案 #10: 見積変更依頼の履歴管理機能
- **実装状況**: ❌ **未実装**
- **必要な機能**:
  - 見積変更依頼の履歴記録
  - 見積変更の経緯記録

#### 🚫 改善提案 #12: 顧客満足度管理機能の実装
- **実装状況**: 🚫 **不要（実装しない）**
- **理由**: 業務要件により不要と判断

#### 🚫 改善提案 #13: リソース配分機能の強化
- **実装状況**: 🚫 **不要（実装しない）**
- **理由**: 業務要件により不要と判断

### 優先度: 低

#### ❌ 改善提案 #14: 写真管理機能の強化
- **実装状況**: ❌ **未実装**
- **必要な機能**:
  - 写真の削除機能
  - 写真の順番入れ替え機能

#### ❌ 改善提案 #15: 診断結果のプレビュー機能
- **実装状況**: ❌ **未実装**
- **必要な機能**:
  - 保存前のプレビュー
  - プレビューからの編集

---

## 3. ロードマップから抜けている機能（テスト結果から抽出）

### 実装済みだがロードマップに記載がない機能

#### ✅ フィードバック機能（テスト版専用）
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/components/feedback/` - フィードバックコンポーネント
  - `src/app/api/feedback/route.ts` - Google Sheets連携
- **注意**: 本番環境では無効化（`NEXT_PUBLIC_ENABLE_FEEDBACK`環境変数で制御）

#### ✅ 見積バッジの色改善
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/app/admin/estimate/[id]/page.tsx` - 必須整備（赤）、推奨整備（青）、任意整備（グレー）

---

## 4. 部分的実装・要確認項目

### ✅ 出庫完了処理
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/app/presentation/[id]/page.tsx` - `checkOut` API呼び出し、車検チェックリスト処理
  - `src/lib/api.ts` - `checkOut`関数
  - `src/components/features/inspection-checkout-checklist-dialog.tsx` - 車検出庫時チェックリストダイアログ
- **確認**: コードベースで確認済み（車検チェックリスト処理も実装済み）

### ✅ 部品到着通知機能
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/app/admin/estimate/[id]/page.tsx` - 全部品到着時の自動通知
  - `src/components/features/parts-arrival-dialog.tsx` - 連絡ダイアログ（LINE、メール、電話対応）
  - `src/lib/line-api.ts` - LINE通知送信機能
- **確認**: コードベースで確認済み（LINE通知機能も実装済み）

### ✅ 過去の見積・案件参照機能
- **実装状況**: ✅ **実装済み**
- **実装内容**:
  - `src/app/admin/estimate/[id]/page.tsx` - ダイアログ統合、項目コピー機能
  - `src/components/features/historical-estimate-dialog.tsx` - 過去の見積参照ダイアログ
  - `src/components/features/historical-job-dialog.tsx` - 過去の案件参照ダイアログ
  - `src/lib/api.ts` - `fetchHistoricalEstimatesByCustomerId`, `fetchHistoricalJobsByCustomerId`
- **確認**: コードベースで確認済み（データ取得・表示機能も実装済み）

---

## 5. TODOコメントで見つかった未実装項目

### 低優先度（将来実装予定）

1. **Zoho Bookings予約リンク生成機能**
   - 場所: `src/app/admin/estimate/[id]/page.tsx:3047`
   - 優先度: 低

2. **メール送信機能**
   - 場所: `src/app/admin/estimate/[id]/page.tsx:2047`
   - 優先度: 低（LINE通知が優先）

3. **認証APIの実装**
   - 場所: `src/lib/auth.ts:118, 152, 166`
   - 優先度: 低（Phase 6で実装予定）

4. **型定義関連TODO**
   - 場所: 複数ファイル
   - 優先度: 低（型定義の拡張が必要）

---

## 6. 本番環境前の必須実装項目

### 🔴 最優先（本番環境前に実装推奨）

1. **✅ フィルター機能の強化（緊急案件・重要顧客）** - 実装済み
   - 優先度: 高
   - 実装工数: 1-2日
   - 理由: 全役割から要望、業務効率化に直接影響

### 🟡 高優先度（本番環境前に実装推奨）

3. **過去の見積・案件参照機能の動作確認**
   - 優先度: 低
   - 実装工数: 0.5日（動作確認のみ）
   - 理由: 実装済み、動作確認のみ

4. **🚫 予約変更・キャンセル機能の実装** - 不要（実装しない）

### 🟢 中優先度（本番環境後でも可）

5. **✅ 業務分析機能の実装** - 実装済み

6. **❌ 見積変更依頼の履歴管理機能**
   - 優先度: 中
   - 実装工数: 2-3日
   - 理由: 見積業務の管理強化、本番環境後でも可

7. **🚫 顧客満足度管理機能の実装** - 不要（実装しない）

8. **🚫 リソース配分機能の強化** - 不要（実装しない）

9. **✅ 輸入車整備工場特有の診断・作業記録機能** - 実装済み

10. **✅ 詳細情報の表示機能（店長向け）** - 実装済み

### 🔵 低優先度（本番環境後で可）

11. **❌ 写真管理機能の強化**
    - 優先度: 低
    - 実装工数: 1-2日

12. **❌ 診断結果のプレビュー機能**
    - 優先度: 低
    - 実装工数: 1-2日

---

## 7. 実装状況サマリー

### 完全実装済み ✅

- Phase 0-4: ほぼ完全実装
- 承認待ち案件のフォローアップ機能（改善提案 #11）
- 部品調達待ち案件の管理機能（改善提案 #3）
- 見積テンプレート機能（改善提案 #7）
- 検索機能（改善提案 #2）
- フィルター機能の強化（緊急案件・重要顧客）（改善提案 #1）
- 過去の見積・案件参照機能（改善提案 #6）
- 業務分析機能（改善提案 #8）
- 輸入車整備工場特有の診断・作業記録機能の強化（改善提案 #4）
- 詳細情報の表示機能（店長向け）（改善提案 #5）
- 出庫完了処理（車検チェックリスト含む）
- 部品到着通知機能（LINE通知含む）
- フィードバック機能（テスト版専用）

### 部分的実装 ⚠️

- なし（すべて完全実装済み）

### 未実装 ❌

- 見積変更依頼の履歴管理機能（改善提案 #10）
- 写真管理機能の強化（改善提案 #14）
- 診断結果のプレビュー機能（改善提案 #15）

### 不要（実装しない） 🚫

- 予約変更・キャンセル機能（改善提案 #9）
- 顧客満足度管理機能（改善提案 #12）
- リソース配分機能の強化（改善提案 #13）

---

## 8. 本番環境前の推奨アクション

### 即座に実装すべき項目（最優先）

**すべて実装済み** ✅

### 動作確認が必要な項目

1. **過去の見積・案件参照機能** - 実装済み、動作確認のみ（優先度: 低）
2. **出庫完了処理** - 実装済み、動作確認のみ（優先度: 低）
3. **部品到着通知機能** - 実装済み、動作確認のみ（優先度: 低）

### 本番環境後でも可（優先度順）

1. 見積変更依頼の履歴管理機能（改善提案 #10）
2. 写真管理機能の強化（改善提案 #14）
3. 診断結果のプレビュー機能（改善提案 #15）

### 不要（実装しない） 🚫

- 予約変更・キャンセル機能（改善提案 #9）
- 顧客満足度管理機能（改善提案 #12）
- リソース配分機能の強化（改善提案 #13）

---

## 9. 本番環境デプロイ前のチェック項目

### 必須チェック

- [x] 検索機能の実装（✅ 実装済み）
- [x] フィルター機能の強化（緊急案件・重要顧客）（✅ 実装済み）
- [x] 業務分析機能の実装（✅ 実装済み）
- [x] 過去の見積・案件参照機能の実装（✅ 実装済み）
- [x] 出庫完了処理の実装（✅ 実装済み）
- [x] 部品到着通知機能の実装（✅ 実装済み）
- [ ] 過去の見積・案件参照機能の動作確認（優先度: 低）
- [ ] 出庫完了処理の動作確認（優先度: 低）
- [ ] 部品到着通知機能の動作確認（優先度: 低）
- [ ] 全ページのレスポンシブデザイン確認
- [ ] エラーハンドリングの確認
- [ ] オフライン対応の確認
- [ ] パフォーマンステスト
- [ ] セキュリティチェック

### 推奨チェック（本番環境後でも可）

- [ ] 見積変更依頼の履歴管理機能の実装（改善提案 #10）
- [ ] 写真管理機能の強化（改善提案 #14）
- [ ] 診断結果のプレビュー機能（改善提案 #15）

### 不要（実装しない） 🚫

- [x] 予約変更・キャンセル機能（改善提案 #9） - 不要と判断
- [x] 顧客満足度管理機能（改善提案 #12） - 不要と判断
- [x] リソース配分機能の強化（改善提案 #13） - 不要と判断

---

## 10. 更新履歴

- 2025-01-XX: 本番環境前最終チェックリストを作成

